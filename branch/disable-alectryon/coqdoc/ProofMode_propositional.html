<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>ProofMode_propositional</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">File ProofMode_propositional</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ssreflect</span> <span class="id" title="var">ssrfun</span> <span class="id" title="var">ssrbool</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Ltac2</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Ltac2</span> <span class="id" title="var">Control</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Ensembles</span> <span class="id" title="var">Bool</span> <span class="id" title="var">String</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq.Logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">FunctionalExtensionality</span> <span class="id" title="var">Eqdep_dec</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="keyword">Equations</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Program.Tactics</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MatchingLogic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Utils.extralibrary</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Logic</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DerivedOperators_Syntax</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ProofMode_base</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ProofInfo</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">BasicProofSystemLemmas</span><br/>
.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">stdpp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">list</span> <span class="id" title="var">tactics</span> <span class="id" title="var">fin_sets</span> <span class="id" title="var">coGset</span> <span class="id" title="var">gmap</span> <span class="id" title="var">sets</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MatchingLogic.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">stdpp_ext</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">extralibrary</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span><br/>
&nbsp;&nbsp;<span class="id" title="var">MatchingLogic.Logic.Notations</span><br/>
&nbsp;&nbsp;<span class="id" title="var">MatchingLogic.DerivedOperators_Syntax.Notations</span><br/>
.<br/>

<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">list_scope</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ml_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_exactn</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> : <span class="id" title="var">hypotheses</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">name</span> : <span class="id" title="var">string</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">g</span> : <span class="id" title="var">Pattern</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">info</span> : <span class="id" title="var">ProofInfo</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> <span class="id" title="var">g</span>) :: <span class="id" title="var">l₂</span>) <span class="id" title="var">g</span> <span class="id" title="tactic">info</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlExactn" <span class="id" title="keyword">constr</span>(<span class="id" title="var">n</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByIdx</span> <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_exactn</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_exact</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">name</span> <span class="id" title="var">g</span> <span class="id" title="var">idx</span> <span class="id" title="tactic">info</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">find_hyp</span> <span class="id" title="var">name</span> <span class="id" title="var">l</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">idx</span>, (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> <span class="id" title="var">g</span>)) →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="tactic">info</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlExact" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name'</span>)<br/>
:=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">MLGoal_exact</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">name</span> := <span class="id" title="var">name'</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">reflexivity</span><br/>
.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_weakenConclusion'</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">g'</span> (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g'</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_contraction</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span>) ---&gt; (<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_weaken_conclusion_under_implication</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">c</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span>) ---&gt; ((<span class="id" title="var">a</span> ---&gt; (<span class="id" title="var">b</span> ---&gt; <span class="id" title="var">c</span>)) ---&gt; (<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">c</span>))) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_weaken_conclusion_under_implication_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">c</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">a</span> ---&gt; (<span class="id" title="var">b</span> ---&gt; <span class="id" title="var">c</span>)) ---&gt; (<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">c</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_weaken_conclusion_under_implication_meta_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">c</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span> ---&gt; <span class="id" title="var">c</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">a</span> ---&gt; <span class="id" title="var">c</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_weaken_conclusion_iter_under_implication</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">g'</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g'</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (((<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> <span class="id" title="var">l</span>)) ---&gt; ((<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g'</span> <span class="id" title="var">l</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_weaken_conclusion_iter_under_implication_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">g'</span> (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g'</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> <span class="id" title="var">l</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>→<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g'</span> <span class="id" title="var">l</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_weakenConclusion_under_first_implication</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">name</span> <span class="id" title="var">g</span> <span class="id" title="var">g'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> (<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>) :: <span class="id" title="var">l</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> (<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>) :: <span class="id" title="var">l</span>) <span class="id" title="var">g'</span> <span class="id" title="var">i</span> .<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_weaken_conclusion_iter_under_implication_iter</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">g</span> <span class="id" title="var">g'</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g'</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>) :: <span class="id" title="var">l₂</span>)) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g'</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>) :: <span class="id" title="var">l₂</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_weaken_conclusion_iter_under_implication_iter_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">g</span> <span class="id" title="var">g'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g'</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>) :: <span class="id" title="var">l₂</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g'</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>) :: <span class="id" title="var">l₂</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_weakenConclusion</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">name</span> <span class="id" title="var">g</span> <span class="id" title="var">g'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> (<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>)) :: <span class="id" title="var">l₂</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> (<span class="id" title="var">g</span> ---&gt; <span class="id" title="var">g'</span>)) :: <span class="id" title="var">l₂</span>) <span class="id" title="var">g'</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlApplyn" <span class="id" title="keyword">constr</span>(<span class="id" title="var">n</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByIdx</span> <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_weakenConclusion</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsBack</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlApply" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name'</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByName</span> <span class="id" title="var">name'</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_weakenConclusion</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsBack</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Constructive_dilemma</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">s</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">p</span> ---&gt; <span class="id" title="var">q</span>) ---&gt; (<span class="id" title="var">r</span> ---&gt; <span class="id" title="var">s</span>) ---&gt; (<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">r</span>) ---&gt; (<span class="id" title="var">q</span> <span class="id" title="var">or</span> <span class="id" title="var">s</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_impl_distr_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">c</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">a</span> ---&gt; (<span class="id" title="var">b</span> ---&gt; <span class="id" title="var">c</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span>) ---&gt; (<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">c</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_add_lemma_under_implication</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">h</span> <span class="id" title="var">l</span>) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">h</span>])) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> <span class="id" title="var">l</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_add_lemma_under_implication_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">h</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">h</span>])) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> <span class="id" title="var">l</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_add_lemma_under_implication_meta_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">h</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">h</span>])) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mlGoal_assert</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">name</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> <span class="id" title="var">h</span>]) <span class="id" title="var">g</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_add_lemma_under_implication_generalized</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l1</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l2</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">h</span> <span class="id" title="var">l1</span>) ---&gt; ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l1</span> ++ [<span class="id" title="var">h</span>] ++ <span class="id" title="var">l2</span>)) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l1</span> ++ <span class="id" title="var">l2</span>))))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_add_lemma_under_implication_generalized_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l1</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l2</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">h</span> <span class="id" title="var">l1</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l1</span> ++ [<span class="id" title="var">h</span>] ++ <span class="id" title="var">l2</span>)) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l1</span> ++ <span class="id" title="var">l2</span>))) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_add_lemma_under_implication_generalized_meta_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l1</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l2</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">h</span> <span class="id" title="var">l1</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l1</span> ++ [<span class="id" title="var">h</span>] ++ <span class="id" title="var">l2</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l1</span> ++ <span class="id" title="var">l2</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mlGoal_assert_generalized</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">name</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l1</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l1</span> ++ [<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> <span class="id" title="var">h</span>] ++ <span class="id" title="var">l2</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l1</span> ++ <span class="id" title="var">l2</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "_mlAssert_nocheck" "(" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) ":" <span class="id" title="keyword">constr</span>(<span class="id" title="var">t</span>) ")" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- @<span class="id" title="var">of_MLGoal</span> ?<span class="id" title="var">Sgm</span> (@<span class="id" title="var">mkMLGoal</span> ?<span class="id" title="var">Sgm</span> ?<span class="id" title="var">Ctx</span> ?<span class="id" title="var">l</span> ?<span class="id" title="var">g</span> ?<span class="id" title="var">i</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Hwf</span> := <span class="id" title="tactic">fresh</span> "Hwf" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hwf</span> : <span class="id" title="var">well_formed</span> <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">idtac</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span> : @<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Sgm</span> <span class="id" title="var">Ctx</span> <span class="id" title="var">l</span> <span class="id" title="var">t</span> <span class="id" title="var">i</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | (<span class="id" title="tactic">eapply</span> (@<span class="id" title="var">mlGoal_assert</span> <span class="id" title="var">Sgm</span> <span class="id" title="var">Ctx</span> <span class="id" title="var">l</span> <span class="id" title="var">name</span> <span class="id" title="var">g</span> <span class="id" title="var">t</span> <span class="id" title="var">i</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">rewrite</span> [<span class="id" title="var">_</span> ++ <span class="id" title="var">_</span>]/=; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;make&nbsp;this&nbsp;bind&nbsp;tigther.&nbsp;*)</span><br/>
<span class="id" title="keyword">Tactic Notation</span> "mlAssert" "(" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) ":" <span class="id" title="keyword">constr</span>(<span class="id" title="var">t</span>) ")" :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_failIfUsed</span> <span class="id" title="var">name</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlAssert_nocheck</span> (<span class="id" title="var">name</span> : <span class="id" title="var">t</span>)<br/>
.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlAssert" "(" <span class="id" title="keyword">constr</span> (<span class="id" title="var">t</span>) ")" :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hyps</span> := <span class="id" title="var">_getHypNames</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">name</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">lazy</span> <span class="id" title="tactic">in</span> (<span class="id" title="tactic">fresh</span> <span class="id" title="var">hyps</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">mlAssert</span> (<span class="id" title="var">name</span> : (<span class="id" title="var">t</span>)).<br/>

<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">_getGoalProofInfo</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- @<span class="id" title="var">of_MLGoal</span> ?<span class="id" title="var">Sgm</span> (@<span class="id" title="var">mkMLGoal</span> ?<span class="id" title="var">Sgm</span> ?<span class="id" title="var">Ctx</span> ?<span class="id" title="var">l</span> ?<span class="id" title="var">g</span> ?<span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒ <span class="id" title="var">i</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">_getGoalTheory</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- @<span class="id" title="var">of_MLGoal</span> ?<span class="id" title="var">Sgm</span> (@<span class="id" title="var">mkMLGoal</span> ?<span class="id" title="var">Sgm</span> ?<span class="id" title="var">Ctx</span> ?<span class="id" title="var">l</span> ?<span class="id" title="var">g</span> ?<span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒ <span class="id" title="var">Ctx</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlAssert" "(" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) ":" <span class="id" title="keyword">constr</span>(<span class="id" title="var">t</span>) ")" "using" "first" <span class="id" title="keyword">constr</span>(<span class="id" title="var">n</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_failIfUsed</span> <span class="id" title="var">name</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- @<span class="id" title="var">of_MLGoal</span> ?<span class="id" title="var">Sgm</span> (@<span class="id" title="var">mkMLGoal</span> ?<span class="id" title="var">Sgm</span> ?<span class="id" title="var">Ctx</span> ?<span class="id" title="var">l</span> ?<span class="id" title="var">g</span> ?<span class="id" title="var">i</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l1</span> := <span class="id" title="tactic">fresh</span> "l1" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l2</span> := <span class="id" title="tactic">fresh</span> "l2" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Heql1</span> := <span class="id" title="tactic">fresh</span> "Heql1" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Heql2</span> := <span class="id" title="tactic">fresh</span> "Heql2" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">l1</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heql1</span> <span class="id" title="tactic">in</span> |-;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">l2</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heql2</span> <span class="id" title="tactic">in</span> |-;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heql1</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heql2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">cast_proof_ml_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -[<span class="id" title="var">l</span>](<span class="id" title="var">take_drop</span> <span class="id" title="var">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Hwf</span> := <span class="id" title="tactic">fresh</span> "Hwf" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hwf</span> : <span class="id" title="var">well_formed</span> <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">idtac</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span> : @<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Sgm</span> <span class="id" title="var">Ctx</span> <span class="id" title="var">l1</span> <span class="id" title="var">t</span> <span class="id" title="var">i</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">eapply</span> <span class="id" title="var">cast_proof_ml_hyps</span>; [(<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heql1</span>; <span class="id" title="tactic">reflexivity</span>)|]);  <span class="id" title="tactic">clear</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">Heql1</span> <span class="id" title="var">Heql2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">apply</span> (<span class="id" title="var">cast_proof_ml_hyps</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="tactic">f_equal</span> <span class="id" title="var">patterns_of</span> <span class="id" title="var">Heql1</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (@<span class="id" title="var">mlGoal_assert_generalized</span> <span class="id" title="var">Sgm</span> <span class="id" title="var">Ctx</span> (<span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) (<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) <span class="id" title="var">name</span> <span class="id" title="var">g</span> <span class="id" title="var">t</span> <span class="id" title="var">i</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">H</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> [<span class="id" title="var">_</span> ++ <span class="id" title="var">_</span>]/=; <span class="id" title="tactic">clear</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">Heql1</span> <span class="id" title="var">Heql2</span> <span class="id" title="var">H</span>] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlAssert" "(" <span class="id" title="keyword">constr</span>(<span class="id" title="var">t</span>) ")" "using" "first" <span class="id" title="keyword">constr</span>(<span class="id" title="var">n</span>)  :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hyps</span> := <span class="id" title="var">_getHypNames</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">name</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">cbv</span> <span class="id" title="tactic">in</span> (<span class="id" title="tactic">fresh</span> <span class="id" title="var">hyps</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">mlAssert</span> (<span class="id" title="var">name</span> : <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="tactic">first</span> <span class="id" title="var">n</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">P4i'</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">Pattern</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((!<span class="id" title="var">A</span> ---&gt; <span class="id" title="var">A</span>) ---&gt; <span class="id" title="var">A</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">tofold</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">p</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">p</span> = <span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">p</span> [].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">consume</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">l</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> (<span class="id" title="var">p</span> ---&gt; <span class="id" title="var">q</span>) <span class="id" title="var">l</span> = <span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">q</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">p</span>]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_disj_elim</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">p</span> ---&gt; <span class="id" title="var">r</span>) ---&gt; (<span class="id" title="var">q</span> ---&gt; <span class="id" title="var">r</span>) ---&gt; (<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>) ---&gt; <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_disj_elim_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> ---&gt; <span class="id" title="var">r</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">q</span> ---&gt; <span class="id" title="var">r</span>) ---&gt; (<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>) ---&gt; <span class="id" title="var">r</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_disj_elim_meta_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> ---&gt; <span class="id" title="var">r</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">q</span> ---&gt; <span class="id" title="var">r</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>) ---&gt; <span class="id" title="var">r</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_disj_elim_meta_meta_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> ---&gt; <span class="id" title="var">r</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">q</span> ---&gt; <span class="id" title="var">r</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">r</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_add_proved_to_assumptions</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">a</span> <span class="id" title="var">g</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">a</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>→<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">a</span>::<span class="id" title="var">l</span>)) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> <span class="id" title="var">l</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_add_proved_to_assumptions_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">a</span> <span class="id" title="var">g</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">a</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">a</span>::<span class="id" title="var">l</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_add</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">name</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">h</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> <span class="id" title="var">h</span>::<span class="id" title="var">l</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlAdd" <span class="id" title="keyword">constr</span>(<span class="id" title="var">n</span>) "as" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name'</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_failIfUsed</span> <span class="id" title="var">name'</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- @<span class="id" title="var">of_MLGoal</span> ?<span class="id" title="var">Sgm</span> (@<span class="id" title="var">mkMLGoal</span> ?<span class="id" title="var">Sgm</span> ?<span class="id" title="var">Ctx</span> ?<span class="id" title="var">l</span> ?<span class="id" title="var">g</span> ?<span class="id" title="var">i</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">MLGoal_add</span> <span class="id" title="var">Sgm</span> <span class="id" title="var">Ctx</span> <span class="id" title="var">l</span> <span class="id" title="var">name'</span> <span class="id" title="var">g</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlAdd" <span class="id" title="keyword">constr</span>(<span class="id" title="var">n</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hyps</span> := <span class="id" title="var">_getHypNames</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">name</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">cbv</span> <span class="id" title="tactic">in</span> (<span class="id" title="tactic">fresh</span> <span class="id" title="var">hyps</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">mlAdd</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> <span class="id" title="var">name</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_clear_hyp</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l1</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l2</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l1</span> ++ <span class="id" title="var">l2</span>)) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l1</span> ++ [<span class="id" title="var">h</span>] ++ <span class="id" title="var">l2</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_clear_hyp_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l1</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l2</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l1</span> ++ <span class="id" title="var">l2</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l1</span> ++ [<span class="id" title="var">h</span>] ++ <span class="id" title="var">l2</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mlGoal_clear_hyp</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l1</span> ++ <span class="id" title="var">l2</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l1</span> ++ <span class="id" title="var">h</span>::<span class="id" title="var">l2</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlClear" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByName</span> <span class="id" title="var">name</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">mlGoal_clear_hyp</span>; <span class="id" title="var">_mlReshapeHypsBack</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_concl</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> ---&gt; (<span class="id" title="var">q</span> ---&gt; ((<span class="id" title="var">p</span> ---&gt; ! <span class="id" title="var">q</span>) ---&gt; ⊥))) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">reorder_last_to_head</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">x</span>::<span class="id" title="var">l</span>)) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">x</span>]))) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">reorder_last_to_head_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">x</span>::<span class="id" title="var">l</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">x</span>])) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Iterated&nbsp;modus&nbsp;ponens.<br/>
&nbsp;For&nbsp;l&nbsp;=&nbsp;<span class="inlinecode"><span class="id" title="var">x₁</span>,</span> <span class="inlinecode">...,</span> <span class="inlinecode"><span class="id" title="var">x</span>ₙ</span>,&nbsp;it&nbsp;says&nbsp;that<br/>
&nbsp;Γ&nbsp;⊢i&nbsp;((x₁&nbsp;-&gt;&nbsp;...&nbsp;-&gt;&nbsp;xₙ&nbsp;-&gt;&nbsp;(x₁&nbsp;-&gt;&nbsp;...&nbsp;-&gt;&nbsp;xₙ&nbsp;-&gt;&nbsp;r))&nbsp;-&gt;&nbsp;r)<br/>
*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">modus_ponens_iter</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> <span class="id" title="var">l</span>])) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">and_impl</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">p</span> <span class="id" title="var">and</span> <span class="id" title="var">q</span> ---&gt; <span class="id" title="var">r</span>) ---&gt; (<span class="id" title="var">p</span> ---&gt; (<span class="id" title="var">q</span> ---&gt; <span class="id" title="var">r</span>))) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">and_impl'</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">p</span> ---&gt; (<span class="id" title="var">q</span> ---&gt; <span class="id" title="var">r</span>)) ---&gt; ((<span class="id" title="var">p</span> <span class="id" title="var">and</span> <span class="id" title="var">q</span>) ---&gt; <span class="id" title="var">r</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_disj_elim_iter</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">p</span>]))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">q</span>]))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>]))))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_disj_elim_iter_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">p</span>] ++ <span class="id" title="var">l₂</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">q</span>] ++ <span class="id" title="var">l₂</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>] ++ <span class="id" title="var">l₂</span>))))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_disj_elim_iter_2_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">p</span>] ++ <span class="id" title="var">l₂</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">q</span>] ++ <span class="id" title="var">l₂</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>] ++ <span class="id" title="var">l₂</span>))) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_disj_elim_iter_2_meta_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">p</span>] ++ <span class="id" title="var">l₂</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">q</span>] ++ <span class="id" title="var">l₂</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">fold_right</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">r</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>] ++ <span class="id" title="var">l₂</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_disj_elim</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">pn</span> <span class="id" title="var">p</span> <span class="id" title="var">qn</span> <span class="id" title="var">q</span> <span class="id" title="var">pqn</span> <span class="id" title="var">r</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">pn</span> <span class="id" title="var">p</span>] ++ <span class="id" title="var">l₂</span>) <span class="id" title="var">r</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">qn</span> <span class="id" title="var">q</span>] ++ <span class="id" title="var">l₂</span>) <span class="id" title="var">r</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ [<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">pqn</span> (<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>)] ++ <span class="id" title="var">l₂</span>) <span class="id" title="var">r</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlDestructOr" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) "as" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name1</span>) <span class="id" title="keyword">constr</span>(<span class="id" title="var">name2</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_failIfUsed</span> <span class="id" title="var">name1</span>; <span class="id" title="var">_failIfUsed</span> <span class="id" title="var">name2</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- @<span class="id" title="var">of_MLGoal</span> ?<span class="id" title="var">Sgm</span> (@<span class="id" title="var">mkMLGoal</span> ?<span class="id" title="var">Sgm</span> ?<span class="id" title="var">Ctx</span> ?<span class="id" title="var">l</span> ?<span class="id" title="var">g</span> ?<span class="id" title="var">i</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Htd</span> := <span class="id" title="tactic">fresh</span> "Htd" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">cast_proof_ml_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByName</span> <span class="id" title="var">name</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_disj_elim</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">pqn</span> := <span class="id" title="var">name</span>) (<span class="id" title="var">pn</span> := <span class="id" title="var">name1</span>) (<span class="id" title="var">qn</span> := <span class="id" title="var">name2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsBack</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlDestructOr" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hyps</span> := <span class="id" title="var">_getHypNames</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">name0</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">cbv</span> <span class="id" title="tactic">in</span> (<span class="id" title="tactic">fresh</span> <span class="id" title="var">hyps</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">name1</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">cbv</span> <span class="id" title="tactic">in</span> (<span class="id" title="tactic">fresh</span> (<span class="id" title="var">name0</span> :: <span class="id" title="var">hyps</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">mlDestructOr</span> <span class="id" title="var">name</span> <span class="id" title="keyword">as</span> <span class="id" title="var">name0</span> <span class="id" title="var">name1</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pf_iff_split</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">A</span> ---&gt; <span class="id" title="var">B</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">B</span> ---&gt; <span class="id" title="var">A</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">A</span> &lt;---&gt; <span class="id" title="var">B</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pf_iff_proj1</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">A</span> &lt;---&gt; <span class="id" title="var">B</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">A</span> ---&gt; <span class="id" title="var">B</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pf_iff_proj2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> &lt;---&gt; <span class="id" title="var">B</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">B</span> ---&gt; <span class="id" title="var">A</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pf_iff_iff</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">prod</span> ((<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> &lt;---&gt; <span class="id" title="var">B</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>) → (<span class="id" title="var">prod</span> (<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> ---&gt; <span class="id" title="var">B</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>) (<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">B</span> ---&gt; <span class="id" title="var">A</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;( (<span class="id" title="var">prod</span> (<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> ---&gt; <span class="id" title="var">B</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>)  (<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">B</span> ---&gt; <span class="id" title="var">A</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>)) → (<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> &lt;---&gt; <span class="id" title="var">B</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pf_iff_equiv_refl</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> &lt;---&gt; <span class="id" title="var">A</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pf_iff_equiv_sym</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> &lt;---&gt; <span class="id" title="var">B</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">B</span> &lt;---&gt; <span class="id" title="var">A</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pf_iff_equiv_trans</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">C</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> &lt;---&gt; <span class="id" title="var">B</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">B</span> &lt;---&gt; <span class="id" title="var">C</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> &lt;---&gt; <span class="id" title="var">C</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_conclusion</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">b</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">and_of_negated_iff_not_impl</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p1</span> <span class="id" title="var">p2</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p1</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p2</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (! (! <span class="id" title="var">p1</span> ---&gt; <span class="id" title="var">p2</span>) &lt;---&gt; ! <span class="id" title="var">p1</span> <span class="id" title="var">and</span> ! <span class="id" title="var">p2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">and_impl_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p1</span> <span class="id" title="var">p2</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p1</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p2</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (! (<span class="id" title="var">p1</span> ---&gt; <span class="id" title="var">p2</span>) &lt;---&gt; <span class="id" title="var">p1</span> <span class="id" title="var">and</span> ! <span class="id" title="var">p2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">conj_intro_meta_partial</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">A</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">B</span> ---&gt; (<span class="id" title="var">A</span> <span class="id" title="var">and</span> <span class="id" title="var">B</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">and_impl_patt</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="var">Pattern</span>) <span class="id" title="var">Γ</span> (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">C</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">A</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">A</span> <span class="id" title="var">and</span> <span class="id" title="var">B</span>) ---&gt; <span class="id" title="var">C</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">B</span> ---&gt; <span class="id" title="var">C</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">conj_intro2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">Pattern</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> ---&gt; (<span class="id" title="var">B</span> ---&gt; (<span class="id" title="var">B</span> <span class="id" title="var">and</span> <span class="id" title="var">A</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">conj_intro_meta_partial2</span>  {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">A</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">B</span> ---&gt; (<span class="id" title="var">B</span> <span class="id" title="var">and</span> <span class="id" title="var">A</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">and_impl_patt2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>}  (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="var">Pattern</span>) <span class="id" title="var">Γ</span> (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">C</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">A</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">B</span> <span class="id" title="var">and</span> <span class="id" title="var">A</span>) ---&gt; <span class="id" title="var">C</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">B</span> ---&gt; <span class="id" title="var">C</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_and_comm_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">B</span><br/>
&nbsp;&nbsp;→<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">A</span> <span class="id" title="var">and</span> <span class="id" title="var">B</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">B</span> <span class="id" title="var">and</span> <span class="id" title="var">A</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_applyMeta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">r</span> <span class="id" title="var">r'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">r'</span> ---&gt; <span class="id" title="var">r</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">r'</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">_mlApplyMetaRaw</span> <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (@<span class="id" title="var">MLGoal_applyMeta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">t</span>).<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlApplyMetaRaw" <span class="id" title="var">uconstr</span>(<span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlApplyMetaRaw</span> <span class="id" title="var">t</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">_mlApplyMetaRaw</span> (<span class="id" title="var">t</span> : <span class="id" title="keyword">constr</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (@<span class="id" title="var">MLGoal_applyMeta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> $<span class="id" title="var">t</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_left</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> (<span class="id" title="var">patt_or</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_right</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> (<span class="id" title="var">patt_or</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">mlLeft</span> := <span class="id" title="var">_ensureProofMode</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_left</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">mlRight</span> := <span class="id" title="var">_ensureProofMode</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_right</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_applyMetaIn</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">n</span> <span class="id" title="var">r</span> <span class="id" title="var">n'</span> <span class="id" title="var">r'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">r</span> ---&gt; <span class="id" title="var">r'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">g</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">n'</span> <span class="id" title="var">r'</span>)::<span class="id" title="var">l₂</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span> <span class="id" title="var">r</span>)::<span class="id" title="var">l₂</span> ) <span class="id" title="var">g</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">_mlApplyMetaRawIn</span> <span class="id" title="var">t</span> <span class="id" title="var">name</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">cast_proof_ml_hyps</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByName</span> <span class="id" title="var">name</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (@<span class="id" title="var">MLGoal_applyMetaIn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsBack</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">_mlApplyMetaRawIn</span> (<span class="id" title="var">t</span> : <span class="id" title="keyword">constr</span>) (<span class="id" title="var">name</span> : <span class="id" title="keyword">constr</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">ltac1</span>:(<span class="id" title="var">t'</span> <span class="id" title="var">name'</span> |- <span class="id" title="var">_mlApplyMetaRawIn</span> <span class="id" title="var">t'</span> <span class="id" title="var">name'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Ltac1.of_constr</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Ltac1.of_constr</span> <span class="id" title="var">name</span>)<br/>
.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlApplyMetaRaw" <span class="id" title="var">uconstr</span>(<span class="id" title="var">t</span>) "in" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlApplyMetaRawIn</span> <span class="id" title="var">t</span> <span class="id" title="var">name</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="keyword">rec</span> <span class="id" title="var">applyRec</span> (<span class="id" title="var">f</span> : <span class="id" title="keyword">constr</span>) (<span class="id" title="var">xs</span> : <span class="id" title="keyword">constr</span> <span class="id" title="var">list</span>) : <span class="id" title="keyword">constr</span> <span class="id" title="var">option</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [] ⇒ <span class="id" title="var">Some</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">y</span>::<span class="id" title="var">ys</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lazy_match</span>! <span class="id" title="var">Constr.type</span> <span class="id" title="var">f</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="keyword">∀</span> <span class="id" title="var">_</span> : ?<span class="id" title="var">t</span>, <span class="id" title="var">_</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Control.plus</span> (<span class="id" title="keyword">fun</span> () ⇒ <span class="id" title="var">applyRec</span> <span class="id" title="keyword">constr</span>:($<span class="id" title="var">f</span> $<span class="id" title="var">y</span>) <span class="id" title="var">ys</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">None</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="keyword">Eval</span> (<span class="id" title="var">applyRec</span> <span class="id" title="keyword">constr</span>:(<span class="id" title="var">Nat.add</span>) [<span class="id" title="keyword">constr</span>:(1);<span class="id" title="keyword">constr</span>:(2)]).<br/>

<br/>
<span class="comment">(*<br/>
&nbsp;&nbsp;All&nbsp;thic&nbsp;complicated&nbsp;code&nbsp;is&nbsp;here&nbsp;only&nbsp;for&nbsp;one&nbsp;reason:<br/>
&nbsp;&nbsp;I&nbsp;want&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;first&nbsp;run&nbsp;the&nbsp;tactic&nbsp;with&nbsp;all&nbsp;the&nbsp;parameters<br/>
&nbsp;&nbsp;inferred&nbsp;or&nbsp;question&nbsp;marked,&nbsp;which&nbsp;results&nbsp;in&nbsp;another&nbsp;goal.<br/>
&nbsp;&nbsp;And&nbsp;then&nbsp;I&nbsp;want&nbsp;to&nbsp;handle&nbsp;the&nbsp;subgoals&nbsp;generated&nbsp;by&nbsp;the&nbsp;filling-in<br/>
&nbsp;&nbsp;underscores&nbsp;/&nbsp;question&nbsp;marks.<br/>
&nbsp;&nbsp;In&nbsp;particular,&nbsp;I&nbsp;want&nbsp;the&nbsp;proof&nbsp;mode&nbsp;goals&nbsp;to&nbsp;be&nbsp;generated&nbsp;first,<br/>
&nbsp;&nbsp;and&nbsp;the&nbsp;other,&nbsp;uninteresting&nbsp;goals,&nbsp;next.<br/>
*)</span><br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="keyword">rec</span> <span class="id" title="var">fillWithUnderscoresAndCall</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">tac</span> : <span class="id" title="keyword">constr</span> → <span class="id" title="var">unit</span>) (<span class="id" title="var">t</span> : <span class="id" title="keyword">constr</span>) (<span class="id" title="var">args</span> : <span class="id" title="keyword">constr</span> <span class="id" title="var">list</span>) :=<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;Message.print&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Message.concat<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Message.of_string&nbsp;"fillWithUnderscoresAndCall:&nbsp;t&nbsp;=&nbsp;")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Message.of_constr&nbsp;t)<br/>
&nbsp;&nbsp;);<br/>
&nbsp;&nbsp;Message.print&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Message.concat<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Message.of_string&nbsp;"fillWithUnderscoresAndCall:&nbsp;args&nbsp;=&nbsp;")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.fold_right&nbsp;(Message.concat)&nbsp;(Message.of_string&nbsp;"")&nbsp;(List.map&nbsp;Message.of_constr&nbsp;args))<br/>
&nbsp;&nbsp;);<br/>
&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cont</span> := (<span class="id" title="keyword">fun</span> () ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lazy_match</span>! <span class="id" title="var">Constr.type</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (?<span class="id" title="var">t'</span> → ?<span class="id" title="var">t's</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lazy_match</span>! <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- ?<span class="id" title="var">g</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">h</span> := <span class="id" title="var">Fresh.in_goal</span> <span class="id" title="var">ident</span>:(<span class="id" title="var">h</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span>(<span class="id" title="var">h</span> : $<span class="id" title="var">t'</span> → $<span class="id" title="var">g</span>) &gt; [(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pftprime</span> := <span class="id" title="var">Fresh.in_goal</span> <span class="id" title="var">ident</span>:(<span class="id" title="var">pftprime</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> $<span class="id" title="var">pftprime</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">new_t</span> := <span class="id" title="var">open_constr</span>:($<span class="id" title="var">t</span> <span class="id" title="var">ltac2</span>:(<span class="id" title="var">Notations.exact0</span> <span class="id" title="var">false</span> (<span class="id" title="keyword">fun</span> () ⇒ <span class="id" title="var">Control.hyp</span> (<span class="id" title="var">pftprime</span>)))) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fillWithUnderscoresAndCall</span> <span class="id" title="var">tac</span> <span class="id" title="var">new_t</span> <span class="id" title="var">args</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Std.clear</span> [<span class="id" title="var">pftprime</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)|(<span class="id" title="tactic">apply</span> &amp;<span class="id" title="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="keyword">∀</span> <span class="id" title="var">_</span> : <span class="id" title="var">_</span>, <span class="id" title="var">_</span>) ⇒ <span class="id" title="var">fillWithUnderscoresAndCall</span> <span class="id" title="var">tac</span> <span class="id" title="var">open_constr</span>:($<span class="id" title="var">t</span> <span class="id" title="var">_</span>) <span class="id" title="var">args</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" title="var">remainder</span> ⇒ <span class="id" title="var">throw</span> (<span class="id" title="var">Invalid_argument</span> (<span class="id" title="var">Some</span> (<span class="id" title="var">Message.concat</span> (<span class="id" title="var">Message.concat</span> (<span class="id" title="var">Message.of_string</span> "Remainder type: ") (<span class="id" title="var">Message.of_constr</span> <span class="id" title="var">remainder</span>)) (<span class="id" title="var">Message.concat</span> (<span class="id" title="var">Message.of_string</span> ", of term") (<span class="id" title="var">Message.of_constr</span> <span class="id" title="var">t</span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">applyRec</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">None</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Cannot&nbsp;apply&nbsp;<span class="inlinecode"><span class="id" title="var">t</span></span>&nbsp;to&nbsp;<span class="inlinecode"><span class="id" title="var">args</span></span>&nbsp;=&gt;&nbsp;continue&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cont</span> ()<br/>
&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">result</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Can&nbsp;apply&nbsp;<span class="inlinecode"><span class="id" title="var">to</span></span>&nbsp;to&nbsp;<span class="inlinecode"><span class="id" title="var">args</span></span>,&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lazy_match</span>! <span class="id" title="var">Constr.type</span> <span class="id" title="var">result</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="keyword">∀</span> <span class="id" title="var">_</span> : <span class="id" title="var">_</span>, <span class="id" title="var">_</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;but&nbsp;result&nbsp;would&nbsp;still&nbsp;accept&nbsp;an&nbsp;argument&nbsp;=&gt;&nbsp;continue&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cont</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;and&nbsp;nothing&nbsp;more&nbsp;can&nbsp;be&nbsp;applied&nbsp;to&nbsp;the&nbsp;result&nbsp;=&gt;&nbsp;we&nbsp;are&nbsp;done&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tac</span> <span class="id" title="var">result</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
.<br/>

<br/>
<span class="comment">(*<br/>
&nbsp;&nbsp;We&nbsp;have&nbsp;this&nbsp;double-primed&nbsp;version&nbsp;because&nbsp;we&nbsp;want&nbsp;to&nbsp;be&nbsp;able<br/>
&nbsp;&nbsp;to&nbsp;feed&nbsp;it&nbsp;the&nbsp;proof&nbsp;before&nbsp;feeding&nbsp;it&nbsp;the&nbsp;ProofInfoLe.<br/>
*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">useGenericReasoning''</span>  {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (<span class="id" title="var">ϕ</span> : <span class="id" title="var">Pattern</span>) <span class="id" title="var">i'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">ϕ</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i'</span> →<br/>
&nbsp;&nbsp;(<span class="id" title="var">ProofInfoLe</span> <span class="id" title="var">i'</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">ϕ</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">_callCompletedAndCast</span> (<span class="id" title="var">t</span> : <span class="id" title="keyword">constr</span>) (<span class="id" title="var">tac</span> : <span class="id" title="keyword">constr</span> → <span class="id" title="var">unit</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tac'</span> := (<span class="id" title="keyword">fun</span> (<span class="id" title="var">t'</span> : <span class="id" title="keyword">constr</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tcast</span> := <span class="id" title="var">open_constr</span>:(@<span class="id" title="var">useGenericReasoning''</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> $<span class="id" title="var">t'</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fillWithUnderscoresAndCall</span> <span class="id" title="var">tac</span> <span class="id" title="var">tcast</span> []<br/>
&nbsp;&nbsp;) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">fillWithUnderscoresAndCall</span> <span class="id" title="var">tac'</span> <span class="id" title="var">t</span> []<br/>
.<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">try_solve_pile_basic</span> () :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Control.enter</span> (<span class="id" title="keyword">fun</span> () ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lazy_match</span>! <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- (@<span class="id" title="var">ProofInfoLe</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">solve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">apply</span> <span class="id" title="var">pile_any</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">apply</span> <span class="id" title="var">pile_refl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">apply</span> <span class="id" title="var">pile_basic_generic</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="var">_</span>] ⇒ ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;)<br/>
.<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">try_wfa</span> () :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Control.enter</span> (<span class="id" title="keyword">fun</span> () ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">wfa</span> := (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">Constr.has_evar</span> <span class="id" title="var">p</span>) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ltac1</span>:(<span class="id" title="var">try_wfauto2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lazy_match</span>! <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="var">well_formed</span> ?<span class="id" title="var">p</span> = <span class="id" title="var">true</span>] ⇒ <span class="id" title="var">wfa</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="var">is_true</span> (<span class="id" title="var">well_formed</span> ?<span class="id" title="var">p</span>) ] ⇒ <span class="id" title="var">wfa</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="var">Pattern.wf</span> ?<span class="id" title="var">l</span> = <span class="id" title="var">true</span>] ⇒ <span class="id" title="var">wfa</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="var">is_true</span> (<span class="id" title="var">Pattern.wf</span> ?<span class="id" title="var">l</span>) ] ⇒ <span class="id" title="var">wfa</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="var">_</span>] ⇒ ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;)<br/>
.<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">mlApplyMeta</span> (<span class="id" title="var">t</span> : <span class="id" title="keyword">constr</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_callCompletedAndCast</span> <span class="id" title="var">t</span> <span class="id" title="var">_mlApplyMetaRaw</span> ;<br/>
&nbsp;&nbsp;<span class="id" title="var">try_solve_pile_basic</span> ();<br/>
&nbsp;&nbsp;<span class="id" title="var">try_wfa</span> ()<br/>
.<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">mlApplyMetaIn</span> (<span class="id" title="var">t</span> : <span class="id" title="keyword">constr</span>) (<span class="id" title="var">name</span> : <span class="id" title="keyword">constr</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_callCompletedAndCast</span> <span class="id" title="var">t</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">t</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_mlApplyMetaRawIn</span> <span class="id" title="var">t</span> <span class="id" title="var">name</span><br/>
&nbsp;&nbsp;);<br/>
&nbsp;&nbsp;<span class="id" title="var">try_solve_pile_basic</span> ();<br/>
&nbsp;&nbsp;<span class="id" title="var">try_wfa</span> ()<br/>
.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">_mlApplyMeta</span> <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ff</span> := <span class="id" title="var">ltac2</span>:(<span class="id" title="var">t'</span> |- <span class="id" title="var">mlApplyMeta</span> (<span class="id" title="var">Option.get</span> (<span class="id" title="var">Ltac1.to_constr</span>(<span class="id" title="var">t'</span>)))) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">ff</span> <span class="id" title="var">t</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">_mlApplyMetaIn</span> <span class="id" title="var">t</span> <span class="id" title="var">name</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ff</span> := <span class="id" title="var">ltac2</span>:(<span class="id" title="var">t'</span> <span class="id" title="var">name'</span> |- <span class="id" title="var">mlApplyMetaIn</span> (<span class="id" title="var">Option.get</span> (<span class="id" title="var">Ltac1.to_constr</span>(<span class="id" title="var">t'</span>))) (<span class="id" title="var">Option.get</span> (<span class="id" title="var">Ltac1.to_constr</span>(<span class="id" title="var">name'</span>)))) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">ff</span> <span class="id" title="var">t</span> <span class="id" title="var">name</span><br/>
.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlApplyMeta" <span class="id" title="keyword">constr</span>(<span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlApplyMeta</span> <span class="id" title="var">t</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlApplyMeta" <span class="id" title="keyword">constr</span>(<span class="id" title="var">t</span>) "in" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlApplyMetaIn</span> <span class="id" title="var">t</span> <span class="id" title="var">name</span><br/>
.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_destructAnd</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">g</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">nx</span> <span class="id" title="var">x</span> <span class="id" title="var">ny</span> <span class="id" title="var">y</span> <span class="id" title="var">nxy</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">nx</span> <span class="id" title="var">x</span>)::(<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">ny</span> <span class="id" title="var">y</span>)::<span class="id" title="var">l₂</span> ) <span class="id" title="var">g</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">nxy</span> (<span class="id" title="var">x</span> <span class="id" title="var">and</span> <span class="id" title="var">y</span>))::<span class="id" title="var">l₂</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlDestructAnd" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) "as" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name1</span>) <span class="id" title="keyword">constr</span>(<span class="id" title="var">name2</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_failIfUsed</span> <span class="id" title="var">name1</span>; <span class="id" title="var">_failIfUsed</span> <span class="id" title="var">name2</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">cast_proof_ml_hyps</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByName</span> <span class="id" title="var">name</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_destructAnd</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">nxy</span> := <span class="id" title="var">name</span>) (<span class="id" title="var">nx</span> := <span class="id" title="var">name1</span>) (<span class="id" title="var">ny</span> := <span class="id" title="var">name2</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsBack</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlDestructAnd" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hyps</span> := <span class="id" title="var">_getHypNames</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">name0</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">cbv</span> <span class="id" title="tactic">in</span> (<span class="id" title="tactic">fresh</span> <span class="id" title="var">hyps</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">name1</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">cbv</span> <span class="id" title="tactic">in</span> (<span class="id" title="tactic">fresh</span> (<span class="id" title="var">name0</span> :: <span class="id" title="var">hyps</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">mlDestructAnd</span> <span class="id" title="var">name</span> <span class="id" title="keyword">as</span> <span class="id" title="var">name0</span> <span class="id" title="var">name1</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">and_of_equiv_is_equiv</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">p'</span> <span class="id" title="var">q'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p'</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q'</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> &lt;---&gt; <span class="id" title="var">p'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">q</span> &lt;---&gt; <span class="id" title="var">q'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">p</span> <span class="id" title="var">and</span> <span class="id" title="var">q</span>) &lt;---&gt; (<span class="id" title="var">p'</span> <span class="id" title="var">and</span> <span class="id" title="var">q'</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">or_of_equiv_is_equiv</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">p'</span> <span class="id" title="var">q'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p'</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q'</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> &lt;---&gt; <span class="id" title="var">p'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">q</span> &lt;---&gt; <span class="id" title="var">q'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>) &lt;---&gt; (<span class="id" title="var">p'</span> <span class="id" title="var">or</span> <span class="id" title="var">q'</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">impl_iff_notp_or_q</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">p</span> ---&gt; <span class="id" title="var">q</span>) &lt;---&gt; (! <span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">p_and_notp_is_bot</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (⊥ &lt;---&gt; <span class="id" title="var">p</span> <span class="id" title="var">and</span> ! <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">mlExFalso</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">mlApplyMeta</span> <span class="id" title="var">bot_elim</span><br/>
.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlDestructBot" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name'</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByName</span> <span class="id" title="var">name'</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">mlExFalso</span>; <span class="id" title="var">mlExact</span> <span class="id" title="var">name'</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsBack</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weird_lemma</span>  {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">L</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">R</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (((<span class="id" title="var">L</span> <span class="id" title="var">and</span> <span class="id" title="var">A</span>) ---&gt; (<span class="id" title="var">B</span> <span class="id" title="var">or</span> <span class="id" title="var">R</span>)) ---&gt; (<span class="id" title="var">L</span> ---&gt; ((<span class="id" title="var">A</span> ---&gt; <span class="id" title="var">B</span>) <span class="id" title="var">or</span> <span class="id" title="var">R</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weird_lemma_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">L</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">R</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">L</span> <span class="id" title="var">and</span> <span class="id" title="var">A</span>) ---&gt; (<span class="id" title="var">B</span> <span class="id" title="var">or</span> <span class="id" title="var">R</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">L</span> ---&gt; ((<span class="id" title="var">A</span> ---&gt; <span class="id" title="var">B</span>) <span class="id" title="var">or</span> <span class="id" title="var">R</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">imp_trans_mixed_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">i</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">C</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">D</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">C</span> ---&gt; <span class="id" title="var">A</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">B</span> ---&gt; <span class="id" title="var">D</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">A</span> ---&gt; <span class="id" title="var">B</span>) ---&gt; <span class="id" title="var">C</span> ---&gt; <span class="id" title="var">D</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">and_weaken</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">Γ</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">C</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">B</span> ---&gt; <span class="id" title="var">C</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">A</span> <span class="id" title="var">and</span> <span class="id" title="var">B</span>) ---&gt; (<span class="id" title="var">A</span> <span class="id" title="var">and</span> <span class="id" title="var">C</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">impl_and</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">i</span>: <br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">C</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">D</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> ---&gt; <span class="id" title="var">B</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">C</span> ---&gt; <span class="id" title="var">D</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">A</span> <span class="id" title="var">and</span> <span class="id" title="var">C</span>) ---&gt; (<span class="id" title="var">B</span> <span class="id" title="var">and</span> <span class="id" title="var">D</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">and_drop</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">Γ</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">B</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">C</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">A</span> <span class="id" title="var">and</span> <span class="id" title="var">B</span>) ---&gt; <span class="id" title="var">C</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">A</span> <span class="id" title="var">and</span> <span class="id" title="var">B</span>) ---&gt; (<span class="id" title="var">A</span> <span class="id" title="var">and</span> <span class="id" title="var">C</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_equiv_of_impl_of_equiv</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a'</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b'</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">a</span> &lt;---&gt; <span class="id" title="var">a'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">b</span> &lt;---&gt; <span class="id" title="var">b'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span>) &lt;---&gt; (<span class="id" title="var">a'</span> ---&gt; <span class="id" title="var">b'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lhs_to_and</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">c</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">a</span> <span class="id" title="var">and</span> <span class="id" title="var">b</span>) ---&gt; <span class="id" title="var">c</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span> ---&gt; <span class="id" title="var">c</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lhs_from_and</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">c</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span> ---&gt; <span class="id" title="var">c</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">a</span> <span class="id" title="var">and</span> <span class="id" title="var">b</span>) ---&gt; <span class="id" title="var">c</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_conj_split</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span>) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span>) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> (<span class="id" title="var">a</span> <span class="id" title="var">and</span> <span class="id" title="var">b</span>) <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_conj_split_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span> (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> → <br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span>) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> (<span class="id" title="var">a</span> <span class="id" title="var">and</span> <span class="id" title="var">b</span>) <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_conj_split_meta_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span> (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> → <br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> (<span class="id" title="var">a</span> <span class="id" title="var">and</span> <span class="id" title="var">b</span>) <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_splitAnd</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">a</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">b</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> (<span class="id" title="var">a</span> <span class="id" title="var">and</span> <span class="id" title="var">b</span>) <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">mlSplitAnd</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_splitAnd</span><br/>
.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_local_goals_equiv_impl_full_equiv</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">g₁</span> <span class="id" title="var">g₂</span> <span class="id" title="var">l</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> (<span class="id" title="var">g₁</span> &lt;---&gt; <span class="id" title="var">g₂</span>) <span class="id" title="var">l</span>) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g₁</span> <span class="id" title="var">l</span>) &lt;---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g₂</span> <span class="id" title="var">l</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_local_goals_equiv_impl_full_equiv_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">g₁</span> <span class="id" title="var">g₂</span> <span class="id" title="var">l</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> (<span class="id" title="var">g₁</span> &lt;---&gt; <span class="id" title="var">g₂</span>) <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g₁</span> <span class="id" title="var">l</span>) &lt;---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g₂</span> <span class="id" title="var">l</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_local_goals_equiv_impl_full_equiv_meta_proj1</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">g₁</span> <span class="id" title="var">g₂</span> <span class="id" title="var">l</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> (<span class="id" title="var">g₁</span> &lt;---&gt; <span class="id" title="var">g₂</span>) <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g₁</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g₂</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prf_local_goals_equiv_impl_full_equiv_meta_proj2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">g₁</span> <span class="id" title="var">g₂</span> <span class="id" title="var">l</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> (<span class="id" title="var">g₁</span> &lt;---&gt; <span class="id" title="var">g₂</span>) <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g₂</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g₁</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">top_holds</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">Top</span> <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_iff_phi_top</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">ϕ</span> &lt;---&gt; (<span class="id" title="var">ϕ</span> &lt;---&gt; <span class="id" title="var">Top</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_phi_iff_phi_bott</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (! <span class="id" title="var">ϕ</span> ) &lt;---&gt; (<span class="id" title="var">ϕ</span> &lt;---&gt; ⊥)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_not_iff</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">Pattern</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">A</span> &lt;---&gt; ! ! <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_and_comm</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> <span class="id" title="var">and</span> <span class="id" title="var">q</span>) &lt;---&gt; (<span class="id" title="var">q</span> <span class="id" title="var">and</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="comment">(*&nbsp;We&nbsp;need&nbsp;to&nbsp;come&nbsp;up&nbsp;with&nbsp;tactics&nbsp;that&nbsp;make&nbsp;this&nbsp;easier.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lhs_and_to_imp</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">Pattern</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span> ---&gt; <span class="id" title="var">g</span>) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">xs</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lhs_and_to_imp_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">Pattern</span>) <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span> ---&gt; <span class="id" title="var">g</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">xs</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lhs_imp_to_and</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">Pattern</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">xs</span>)) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span> ---&gt; <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lhs_imp_to_and_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">Pattern</span>) <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> <span class="id" title="var">g</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">xs</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span> ---&gt; <span class="id" title="var">g</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">foldr_and_impl_last</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">x</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">Pattern</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span> ---&gt; <span class="id" title="var">x</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">foldr_and_weaken_last</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">Pattern</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">y</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">x</span> ---&gt; <span class="id" title="var">y</span>) ---&gt; (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span> ---&gt; <span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">y</span> <span class="id" title="var">xs</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">foldr_and_weaken_last_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">Pattern</span>) <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">y</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">x</span> ---&gt; <span class="id" title="var">y</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span> ---&gt; <span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">y</span> <span class="id" title="var">xs</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">foldr_and_last_rotate</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">Pattern</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x1</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x2</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x2</span> (<span class="id" title="var">xs</span> ++ [<span class="id" title="var">x1</span>])) &lt;---&gt; (<span class="id" title="var">x2</span> <span class="id" title="var">and</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x1</span> <span class="id" title="var">xs</span>))) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">foldr_and_last_rotate_1</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">Pattern</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x1</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x2</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x2</span> (<span class="id" title="var">xs</span> ++ [<span class="id" title="var">x1</span>])) ---&gt; (<span class="id" title="var">x2</span> <span class="id" title="var">and</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x1</span> <span class="id" title="var">xs</span>))) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">foldr_and_last_rotate_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">Pattern</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x1</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">x2</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">x2</span> <span class="id" title="var">and</span> (<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x1</span> <span class="id" title="var">xs</span>)) ---&gt; ((<span class="id" title="var">foldr</span> <span class="id" title="var">patt_and</span> <span class="id" title="var">x2</span> (<span class="id" title="var">xs</span> ++ [<span class="id" title="var">x1</span>])))) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>]<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">tryExact</span> <span class="id" title="var">l</span> <span class="id" title="var">idx</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (?<span class="id" title="var">a</span> :: ?<span class="id" title="var">m</span>) ⇒ <span class="id" title="tactic">try</span> <span class="id" title="var">mlExactn</span> <span class="id" title="var">idx</span>; <span class="id" title="var">tryExact</span> <span class="id" title="var">m</span> (<span class="id" title="var">idx</span> + 1)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">mlAssumption</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>; <span class="comment">(*&nbsp;maybe&nbsp;useless?&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- @<span class="id" title="var">of_MLGoal</span> ?<span class="id" title="var">Sgm</span> (@<span class="id" title="var">mkMLGoal</span> ?<span class="id" title="var">Sgm</span> ?<span class="id" title="var">Ctx</span> ?<span class="id" title="var">l</span> ?<span class="id" title="var">g</span> ?<span class="id" title="var">i</span>) ] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tryExact</span> <span class="id" title="var">l</span> 0<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">impl_eq_or</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ( (<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span>) &lt;---&gt; ((! <span class="id" title="var">a</span>) <span class="id" title="var">or</span> <span class="id" title="var">b</span>) )<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nimpl_eq_and</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ( ! (<span class="id" title="var">a</span> ---&gt; <span class="id" title="var">b</span>) &lt;---&gt; (<span class="id" title="var">a</span> <span class="id" title="var">and</span> !<span class="id" title="var">b</span>) )<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deMorgan_nand</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ( !(<span class="id" title="var">a</span> <span class="id" title="var">and</span> <span class="id" title="var">b</span>) &lt;---&gt; (!<span class="id" title="var">a</span> <span class="id" title="var">or</span> !<span class="id" title="var">b</span>) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deMorgan_nor</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ( !(<span class="id" title="var">a</span> <span class="id" title="var">or</span> <span class="id" title="var">b</span>) &lt;---&gt; (!<span class="id" title="var">a</span> <span class="id" title="var">and</span> !<span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_not_eq</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">Pattern</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (!(!<span class="id" title="var">a</span>) &lt;---&gt; <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">and_singleton</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> <span class="id" title="var">p</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> → <span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> <span class="id" title="var">and</span> <span class="id" title="var">p</span>) &lt;---&gt; <span class="id" title="var">p</span> <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bott_and</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ ⊥ <span class="id" title="var">and</span> <span class="id" title="var">ϕ</span> &lt;---&gt; ⊥.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">top_and</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">Top</span> <span class="id" title="var">and</span> <span class="id" title="var">ϕ</span> &lt;---&gt; <span class="id" title="var">ϕ</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_ExactMeta</span> {<span class="id" title="var">Σ</span>:<span class="id" title="var">Signature</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">i</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">g</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">g</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlExactMeta" <span class="id" title="var">uconstr</span>(<span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">MLGoal_ExactMeta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">t</span>).<br/>

<br/>
<span class="id" title="keyword">Goal</span> <span class="id" title="keyword">∀</span> (<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>) <span class="id" title="var">Γ</span>, <span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">Top</span> <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>

<br/>

<br/>
<span class="comment">(**********************************************************************************)</span><br/>

<br/>
<span class="comment">(*&nbsp;This&nbsp;is&nbsp;an&nbsp;example&nbsp;and&nbsp;belongs&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;this&nbsp;file.<br/>
&nbsp;&nbsp;&nbsp;Its&nbsp;only&nbsp;purpose&nbsp;is&nbsp;only&nbsp;to&nbsp;show&nbsp;as&nbsp;many&nbsp;tactics&nbsp;as&nbsp;possible.\<br/>
&nbsp;*)</span><br/>
&nbsp;<span class="id" title="keyword">Example</span> <span class="id" title="var">ex_and_of_equiv_is_equiv_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">p'</span> <span class="id" title="var">q'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p'</span> →<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q'</span> →<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> &lt;---&gt; <span class="id" title="var">p'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">q</span> &lt;---&gt; <span class="id" title="var">q'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">p</span> <span class="id" title="var">and</span> <span class="id" title="var">q</span>) &lt;---&gt; (<span class="id" title="var">p'</span> <span class="id" title="var">and</span> <span class="id" title="var">q'</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <span class="id" title="var">ex_or_of_equiv_is_equiv_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">p'</span> <span class="id" title="var">q'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p'</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q'</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">p</span> &lt;---&gt; <span class="id" title="var">p'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">q</span> &lt;---&gt; <span class="id" title="var">q'</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">p</span> <span class="id" title="var">or</span> <span class="id" title="var">q</span>) &lt;---&gt; (<span class="id" title="var">p'</span> <span class="id" title="var">or</span> <span class="id" title="var">q'</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">list_scope</span>.<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ml_scope</span>.<br/>
</div>
<hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>