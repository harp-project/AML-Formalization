<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Definedness_ProofSystem</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">File Definedness_ProofSystem</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">MatchingLogic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Definedness_Syntax</span> <span class="id" title="var">MLPM</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">MatchingLogic.Logic.Notations</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">MatchingLogic.Theories.Definedness_Syntax.Notations</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">list_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">ProofSystemTheorems</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}<br/>
.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">defFP</span> : <span class="id" title="var">coWfpSet</span> := {[(<span class="id" title="var">exist</span> (<span class="id" title="var">λ</span> <span class="id" title="var">p</span>, <span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> = <span class="id" title="var">true</span>) (<span class="id" title="var">definedness</span>) <span class="id" title="var">erefl</span>)]}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_impl_total_phi_meta</span> <span class="id" title="var">Γ</span> φ <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> <span class="id" title="var">BasicReasoning</span> <span class="id" title="var">i</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ φ ⌋ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_iff_implies_equal</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (φ1 φ2 : <span class="id" title="var">Pattern</span>) <span class="id" title="var">Γ</span> <span class="id" title="var">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ1 →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ2 →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> <span class="id" title="var">BasicReasoning</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ1 &lt;---&gt; φ2) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ1 =<span class="id" title="var">ml</span> φ2 <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_equal_refl</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> φ <span class="id" title="var">Γ</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ =<span class="id" title="var">ml</span> φ<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>
&nbsp;&nbsp;#[<span class="id" title="var">global</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <span class="id" title="var">patt_equal_is_reflexive</span> : <span class="id" title="var">MLReflexive</span> <span class="id" title="var">patt_equal</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">ProofSystemTheorems</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">patt_equal_is_reflexive</span> : <span class="id" title="var">core</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <span class="id" title="var">reflexive_equal_test</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">_</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">p'</span> <span class="id" title="var">q'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p'</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q'</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">q</span> ---&gt; <span class="id" title="var">q'</span> ---&gt; <span class="id" title="var">p'</span> ---&gt; <span class="id" title="var">p</span> =<span class="id" title="var">ml</span> <span class="id" title="var">p</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">ProofSystemTheorems</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}<br/>
&nbsp;&nbsp;.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">use_defined_axiom</span> <span class="id" title="var">Γ</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">patt_defined</span> <span class="id" title="var">p_x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">BasicReasoningWithDefinedness</span> := (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">defined_evar</span> <span class="id" title="var">Γ</span> <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌈ <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ⌉<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span>  (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ceil_monotonic</span> <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span> <span class="id" title="var">i</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ<span class="id" title="var">₁</span> ---&gt; φ<span class="id" title="var">₂</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌈ φ<span class="id" title="var">₁</span> ⌉ ---&gt; ⌈ φ<span class="id" title="var">₂</span> ⌉ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">floor_monotonic</span>  <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span> <span class="id" title="var">i</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ<span class="id" title="var">₁</span> ---&gt; φ<span class="id" title="var">₂</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ φ<span class="id" title="var">₁</span> ⌋ ---&gt; ⌊ φ<span class="id" title="var">₂</span> ⌋ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_equal_sym</span> <span class="id" title="var">Γ</span> φ1 φ2:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ1 → <span class="id" title="var">well_formed</span> φ2 →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ1 =<span class="id" title="var">ml</span> φ2 ---&gt; φ2 =<span class="id" title="var">ml</span> φ1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_equal_comm</span> φ φ' <span class="id" title="var">Γ</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ' →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ =<span class="id" title="var">ml</span> φ') &lt;---&gt; (φ' =<span class="id" title="var">ml</span> φ) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_context_impl_defined</span> <span class="id" title="var">Γ</span> <span class="id" title="var">AC</span> φ <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ (<span class="id" title="var">free_evars</span> φ ∪ <span class="id" title="var">AC_free_evars</span> <span class="id" title="var">AC</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">subst_ctx</span> <span class="id" title="var">AC</span> φ) ---&gt; ⌈ φ ⌉<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span>  (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]} ∪ {[<span class="id" title="var">x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_union_empty</span> φ:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">elements</span> (<span class="id" title="var">free_evars</span> φ ∪ ∅) = <span class="id" title="var">elements</span> (<span class="id" title="var">free_evars</span> φ).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_impl_defined_phi</span> <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ ---&gt; ⌈ φ ⌉<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>;<span class="id" title="var">x</span>]},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">total_phi_impl_phi</span> <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ φ ⌋ ---&gt; φ<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">total_phi_impl_phi_meta</span> <span class="id" title="var">Γ</span> φ <span class="id" title="var">i</span> <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ φ ⌋ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">framing_left_under_tot_impl</span> <span class="id" title="var">Γ</span> ψ <span class="id" title="var">phi1</span> <span class="id" title="var">phi2</span> <span class="id" title="var">psi</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">phi1</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">phi2</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">psi</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> ψ ∪ <span class="id" title="var">free_evars</span> <span class="id" title="var">psi</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ ψ ⌋ ---&gt; <span class="id" title="var">phi1</span> ---&gt; <span class="id" title="var">phi2</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ ψ ⌋ ---&gt; (<span class="id" title="var">phi1</span> ⋅ <span class="id" title="var">psi</span>) ---&gt; (<span class="id" title="var">phi2</span> ⋅ <span class="id" title="var">psi</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">framing_right_under_tot_impl</span> <span class="id" title="var">Γ</span> ψ <span class="id" title="var">phi1</span> <span class="id" title="var">phi2</span> <span class="id" title="var">psi</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">phi1</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">phi2</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">psi</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> ψ ∪ <span class="id" title="var">free_evars</span> <span class="id" title="var">psi</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ ψ ⌋ ---&gt; <span class="id" title="var">phi1</span> ---&gt; <span class="id" title="var">phi2</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ ψ ⌋ ---&gt; (<span class="id" title="var">psi</span> ⋅ <span class="id" title="var">phi1</span>) ---&gt; (<span class="id" title="var">psi</span> ⋅ <span class="id" title="var">phi2</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">deduction_theorem_noKT</span> <span class="id" title="var">Γ</span> φ ψ<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gpi</span> : <span class="id" title="var">ProofInfo</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : <span class="id" title="var">Γ</span> ∪ {[ ψ ]} ⊢<span class="id" title="var">i</span> φ <span class="id" title="keyword">using</span>  <span class="id" title="var">gpi</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;x&nbsp;∈&nbsp;pi_generalized_evars&nbsp;gpi&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pi_generalized_evars</span> <span class="id" title="var">gpi</span> ## (<span class="id" title="var">gset_to_coGset</span> (<span class="id" title="var">free_evars</span> ψ)) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pi_substituted_svars</span> <span class="id" title="var">gpi</span> ## (<span class="id" title="var">gset_to_coGset</span> (<span class="id" title="var">free_svars</span> ψ)) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pi_uses_kt</span> <span class="id" title="var">gpi</span> = <span class="id" title="var">false</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ ψ ⌋ ---&gt; φ<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>
</div>

<div class="doc">
TODO: for this proof, the free variables in patterns of Framing need to be
              traced!!!!
     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_introduction</span> <span class="id" title="var">Γ</span> φ <span class="id" title="var">i</span> <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">KT</span> := <span class="id" title="var">false</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AKT</span> := <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">all</span>, ((<span class="id" title="var">patt_bound_evar</span> 0) ∈<span class="id" title="var">ml</span> φ)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_implies_implication</span> <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> <span class="id" title="var">ϕ</span> ---&gt; <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ---&gt; <span class="id" title="var">ϕ</span> <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_implies_implication_meta</span> <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> <span class="id" title="var">ϕ</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ---&gt; <span class="id" title="var">ϕ</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_elimination</span> <span class="id" title="var">Γ</span> φ <span class="id" title="var">i</span> <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">x</span>]},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">KT</span> := <span class="id" title="var">false</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AKT</span> := <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id" title="var">i</span> →<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">all</span>, ((<span class="id" title="var">patt_bound_evar</span> 0) ∈<span class="id" title="var">ml</span> φ) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_not_1</span> <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span>) ∈<span class="id" title="var">ml</span> (! φ)) ---&gt; ! ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span>) ∈<span class="id" title="var">ml</span> φ)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_not_2</span> <span class="id" title="var">Γ</span> (φ : <span class="id" title="var">Pattern</span>) <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((!(<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ)) ---&gt; (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (! φ)))%<span class="id" title="var">ml</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span>  (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_not_iff</span> <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span>) ∈<span class="id" title="var">ml</span> (! φ)) &lt;---&gt; ! ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span>) ∈<span class="id" title="var">ml</span> φ)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span>  (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_or_1</span> <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span>)) ---&gt; ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) <span class="id" title="var">or</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_or_2</span> <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) <span class="id" title="var">or</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>)) ---&gt; (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_or_iff</span> <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span>)) &lt;---&gt; ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) <span class="id" title="var">or</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_and_1</span> <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">and</span> φ<span class="id" title="var">₂</span>)) ---&gt; ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) <span class="id" title="var">and</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span>  (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_and_2</span> <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) <span class="id" title="var">and</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>)) ---&gt; (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">and</span> φ<span class="id" title="var">₂</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span>  (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_and_iff</span> <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">and</span> φ<span class="id" title="var">₂</span>)) &lt;---&gt; ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) <span class="id" title="var">and</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span>  (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_free_in_path</span> φ:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu_free</span> φ = <span class="id" title="var">true</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">mu_in_evar_path</span> <span class="id" title="var">x</span> φ 0 = <span class="id" title="var">false</span>.<br/>

<br/>
</div>

<div class="doc">
Induction-based eq_elim proof 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equality_elimination_basic_mfpath</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> φ1 φ2 <span class="id" title="var">C</span> <span class="id" title="var">x</span> (<span class="id" title="var">xs</span> : <span class="id" title="var">EVarSet</span>) <span class="id" title="var">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">HΓ</span> : <span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">WF1</span> : <span class="id" title="var">well_formed</span> φ1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">WF2</span> :  <span class="id" title="var">well_formed</span> φ2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">WFC</span> : <span class="id" title="var">PC_wf</span> <span class="id" title="var">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Hfree</span> : {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]} ∪ <span class="id" title="var">free_evars</span> φ1 ∪ <span class="id" title="var">free_evars</span> φ2 ∪ <span class="id" title="var">free_evars</span> (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>) ## <span class="id" title="var">xs</span>)<br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;TODO:&nbsp;use&nbsp;this:&nbsp;&nbsp;(Hfree&nbsp;:&nbsp;fresh_evars&nbsp;xs&nbsp;{<span class="inlinecode"><span class="id" title="var">ev_x</span>;</span> <span class="inlinecode"><span class="id" title="var">x</span></span>}&nbsp;∪&nbsp;free_evars&nbsp;φ1&nbsp;∪&nbsp;free_evars&nbsp;φ2&nbsp;∪&nbsp;free_evars&nbsp;(pcPattern&nbsp;C))&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Hfree2</span> : <span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ1 ∪ <span class="id" title="var">free_evars</span> φ2 ∪ <span class="id" title="var">free_evars</span> (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Henough</span> : <span class="id" title="var">size</span> <span class="id" title="var">xs</span> ≥ <span class="id" title="var">maximal_exists_depth_to</span> 0 (<span class="id" title="var">pcEvar</span> <span class="id" title="var">C</span>) (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Hmu_less</span> : <span class="id" title="var">mu_in_evar_path</span> (<span class="id" title="var">pcEvar</span> <span class="id" title="var">C</span>) (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>) 0 = <span class="id" title="var">false</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]} ∪ <span class="id" title="var">coGset.gset_to_coGset</span> <span class="id" title="var">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">KT</span> := <span class="id" title="var">false</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ1 =<span class="id" title="var">ml</span> φ2) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ1) ---&gt; (<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equality_elimination_basic_mfpath_original</span> <span class="id" title="var">Γ</span> φ1 φ2 <span class="id" title="var">C</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">HΓ</span> : <span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">WF1</span> : <span class="id" title="var">well_formed</span> φ1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">WF2</span> :  <span class="id" title="var">well_formed</span> φ2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">WFC</span> : <span class="id" title="var">PC_wf</span> <span class="id" title="var">C</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu_in_evar_path</span> (<span class="id" title="var">pcEvar</span> <span class="id" title="var">C</span>) (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>) 0 = <span class="id" title="var">false</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ1 =<span class="id" title="var">ml</span> φ2) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ1) &lt;---&gt; (<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equality_elimination_basic</span> <span class="id" title="var">Γ</span> φ1 φ2 <span class="id" title="var">C</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">HΓ</span> : <span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">WF1</span> : <span class="id" title="var">well_formed</span> φ1)<br/>
&nbsp;&nbsp;(<span class="id" title="var">WF2</span> :  <span class="id" title="var">well_formed</span> φ2)<br/>
&nbsp;&nbsp;(<span class="id" title="var">WFC</span> : <span class="id" title="var">PC_wf</span> <span class="id" title="var">C</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>) →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ1 =<span class="id" title="var">ml</span> φ2) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ1) &lt;---&gt; (<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ2)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equality_elimination_basic_ar</span> <span class="id" title="var">Γ</span> φ1 φ2 <span class="id" title="var">C</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ1 →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ2 →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PC_wf</span> <span class="id" title="var">C</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu_in_evar_path</span> (<span class="id" title="var">pcEvar</span> <span class="id" title="var">C</span>) (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>) 0 = <span class="id" title="var">false</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ1 =<span class="id" title="var">ml</span> φ2) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ1) &lt;---&gt; (<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;NOTE:&nbsp;could&nbsp;this&nbsp;also&nbsp;be&nbsp;solved&nbsp;withouth&nbsp;induction?&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equality_elimination_basic_ar_iter_1</span> <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span> <span class="id" title="var">l</span> <span class="id" title="var">C</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PC_wf</span> <span class="id" title="var">C</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu_in_evar_path</span> (<span class="id" title="var">pcEvar</span> <span class="id" title="var">C</span>) (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>) 0 = <span class="id" title="var">false</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> ((<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ<span class="id" title="var">₁</span>) &lt;---&gt; (<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ<span class="id" title="var">₂</span>)) ((φ<span class="id" title="var">₁</span> =<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>) :: <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;this&nbsp;should&nbsp;NOT&nbsp;be&nbsp;done&nbsp;this&nbsp;way&nbsp;probably.&nbsp;There&nbsp;should&nbsp;be&nbsp;a&nbsp;general&nbsp;lemma,&nbsp;which&nbsp;can&nbsp;propagate&nbsp;another&nbsp;"foldr"&nbsp;lemma&nbsp;inside&nbsp;l₁,&nbsp;since&nbsp;there&nbsp;are&nbsp;other&nbsp;theorems&nbsp;that&nbsp;use&nbsp;the&nbsp;same&nbsp;scheme&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equality_elimination_basic_ar_iter</span> <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">C</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Pattern.wf</span> <span class="id" title="var">l₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PC_wf</span> <span class="id" title="var">C</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu_in_evar_path</span> (<span class="id" title="var">pcEvar</span> <span class="id" title="var">C</span>) (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>) 0 = <span class="id" title="var">false</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">foldr</span> <span class="id" title="var">patt_imp</span> ((<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ<span class="id" title="var">₁</span>) &lt;---&gt; (<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ<span class="id" title="var">₂</span>)) (<span class="id" title="var">l₁</span> ++ (φ<span class="id" title="var">₁</span> =<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>)::<span class="id" title="var">l₂</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Corollary</span> <span class="id" title="var">equality_elimination_proj</span> <span class="id" title="var">Γ</span> φ1 φ2 ψ:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu_free</span> ψ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ1 → <span class="id" title="var">well_formed</span> φ2 → <span class="id" title="var">well_formed_closed_ex_aux</span> ψ 1 → <span class="id" title="var">well_formed_closed_mu_aux</span> ψ 0 →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ1 =<span class="id" title="var">ml</span> φ2) ---&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ψ^[<span class="id" title="tactic">evar</span>: 0 ↦ φ1]) ---&gt; (ψ^[<span class="id" title="tactic">evar</span>: 0 ↦ φ2])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">evar_quantify_equal_simpl</span> : <span class="id" title="keyword">∀</span> φ1 φ2 <span class="id" title="var">x</span> <span class="id" title="var">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evar_quantify</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> (φ1 =<span class="id" title="var">ml</span> φ2) = (<span class="id" title="var">evar_quantify</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> φ1) =<span class="id" title="var">ml</span> (<span class="id" title="var">evar_quantify</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> φ2).<br/>
 
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_functional</span> φ : <span class="id" title="var">Pattern</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ex</span>, φ =<span class="id" title="var">ml</span> <span class="id" title="var">b0</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">exists_functional_subst</span> φ φ' <span class="id" title="var">Γ</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu_free</span> φ → <span class="id" title="var">well_formed</span> φ' → <span class="id" title="var">well_formed_closed_ex_aux</span> φ 1 → <span class="id" title="var">well_formed_closed_mu_aux</span> φ 0 →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">patt_exists</span> φ) φ') <span class="id" title="var">and</span> <span class="id" title="var">is_functional</span> φ') ---&gt; (<span class="id" title="var">patt_exists</span> φ)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Corollary</span> <span class="id" title="var">forall_functional_subst</span> φ φ' <span class="id" title="var">Γ</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu_free</span> φ → <span class="id" title="var">well_formed</span> φ' → <span class="id" title="var">well_formed_closed_ex_aux</span> φ 1 → <span class="id" title="var">well_formed_closed_mu_aux</span> φ 0 →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">patt_forall</span> φ) <span class="id" title="var">and</span> (<span class="id" title="var">patt_exists</span> (<span class="id" title="var">patt_equal</span> φ' (<span class="id" title="var">patt_bound_evar</span> 0)))) ---&gt; (φ^[<span class="id" title="tactic">evar</span>: 0 ↦ φ'])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">ProofSystemTheorems</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_rewriteBy</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (<span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> : <span class="id" title="var">hypotheses</span>) <span class="id" title="var">name</span> (φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">C</span> : <span class="id" title="var">PatternCtx</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_in_evar_path</span> (<span class="id" title="var">pcEvar</span> <span class="id" title="var">C</span>) (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>) 0 = <span class="id" title="var">false</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> (φ<span class="id" title="var">₁</span> =<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>)) :: <span class="id" title="var">l₂</span>) (<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ<span class="id" title="var">₂</span>) <span class="id" title="var">AnyReasoning</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> (φ<span class="id" title="var">₁</span> =<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>)) :: <span class="id" title="var">l₂</span>) (<span class="id" title="var">emplace</span> <span class="id" title="var">C</span> φ<span class="id" title="var">₁</span>) <span class="id" title="var">AnyReasoning</span> .<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">mlRewriteBy</span> (<span class="id" title="var">name'</span> : <span class="id" title="keyword">constr</span>) (<span class="id" title="var">atn</span> : <span class="id" title="var">int</span>) :=<br/>
<span class="id" title="var">_mlReshapeHypsByName</span> <span class="id" title="var">name'</span>;<br/>
<span class="id" title="var">lazy_match</span>! <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
| [ |- @<span class="id" title="var">of_MLGoal</span> ?<span class="id" title="var">sgm</span> (@<span class="id" title="var">mkMLGoal</span> ?<span class="id" title="var">sgm</span> ?<span class="id" title="var">g</span> (?<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (?<span class="id" title="var">a'</span> =<span class="id" title="var">ml</span> ?<span class="id" title="var">a</span>))::?<span class="id" title="var">l₂</span>) ?<span class="id" title="var">p</span> <span class="id" title="var">AnyReasoning</span>)]<br/>
&nbsp;&nbsp;⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hr</span> : <span class="id" title="var">HeatResult</span> := <span class="id" title="var">heat</span> <span class="id" title="var">atn</span> <span class="id" title="var">a'</span> <span class="id" title="var">p</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">heq</span> := <span class="id" title="var">Control.hyp</span> (<span class="id" title="var">hr</span>.(<span class="id" title="var">equality</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pc</span> := (<span class="id" title="var">hr</span>.(<span class="id" title="var">pc</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (@<span class="id" title="var">cast_proof_ml_goal</span> <span class="id" title="var">_</span> $<span class="id" title="var">g</span>) &gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">rewrite</span> $<span class="id" title="var">heq</span>; <span class="id" title="tactic">reflexivity</span> | ()];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Std.clear</span> [<span class="id" title="var">hr</span>.(<span class="id" title="var">equality</span>)];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Control.plus</span>(<span class="id" title="keyword">fun</span> () ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_rewriteBy</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt; [ <span class="id" title="tactic">try</span> (<span class="id" title="keyword">match</span>! <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">hyp</span> : ?<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] ⇒ <span class="id" title="tactic">unfold</span> <span class="id" title="var">theory</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">ltac1</span>:(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;idtac&nbsp;"Trying&nbsp;set&nbsp;solving";&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">timeout</span> 5 <span class="id" title="var">set_solver</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Control.plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> () ⇒ <span class="id" title="var">ltac1</span>:(<span class="id" title="var">now</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">mu_free_in_path</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">assumption</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">exn</span> ⇒ <span class="id" title="keyword">let</span> <span class="id" title="var">star</span> := <span class="id" title="var">hr</span>.(<span class="id" title="var">star_ident</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ltac1</span>:(<span class="id" title="var">star</span> |-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">mu_in_evar_path</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">case_match</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> <span class="id" title="var">G</span> [<span class="id" title="var">maximal_mu_depth_to</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] |- <span class="id" title="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;idtac&nbsp;"rewriting";&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> → <span class="id" title="var">maximal_mu_depth_to_0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">try</span> <span class="id" title="var">timeout</span> 5 (<span class="id" title="tactic">subst</span> <span class="id" title="var">star</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">solve_fresh</span>))<span class="comment">(*&nbsp;This&nbsp;is&nbsp;potentially&nbsp;non-terminating,&nbsp;hence&nbsp;the&nbsp;timeout&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) (<span class="id" title="var">Ltac1.of_ident</span> <span class="id" title="var">star</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;improve&nbsp;these&nbsp;heuristics&nbsp;above&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">lazy_match</span>! <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="var">of_MLGoal</span> (@<span class="id" title="var">mkMLGoal</span> ?<span class="id" title="var">sgm</span> ?<span class="id" title="var">g</span> ?<span class="id" title="var">l</span> ?<span class="id" title="var">p</span> <span class="id" title="var">AnyReasoning</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">heq2</span> := <span class="id" title="var">Fresh.in_goal</span> <span class="id" title="var">ident</span>:(<span class="id" title="var">heq2</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">plugged</span> := <span class="id" title="var">Pattern.instantiate</span> (<span class="id" title="var">hr</span>.(<span class="id" title="var">ctx</span>)) <span class="id" title="var">a</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span>(<span class="id" title="var">heq2</span>: ($<span class="id" title="var">p</span> = $<span class="id" title="var">plugged</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt; [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> (<span class="id" title="var">ltac1</span>:(<span class="id" title="var">star</span> |- <span class="id" title="var">simplify_emplace_2</span> <span class="id" title="var">star</span>) (<span class="id" title="var">Ltac1.of_ident</span> (<span class="id" title="var">hr</span>.(<span class="id" title="var">star_ident</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">heq2_pf</span> := <span class="id" title="var">Control.hyp</span> <span class="id" title="var">heq2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (@<span class="id" title="var">cast_proof_ml_goal</span> <span class="id" title="var">_</span> $<span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="keyword">goal</span> := $<span class="id" title="var">plugged</span>) &gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">ltac1</span>:(<span class="id" title="var">heq2</span> |- <span class="id" title="tactic">rewrite</span> [<span class="id" title="tactic">left</span> <span class="id" title="tactic">in</span> <span class="id" title="var">_</span> = <span class="id" title="tactic">left</span>] <span class="id" title="var">heq2</span>; <span class="id" title="tactic">reflexivity</span>) (<span class="id" title="var">Ltac1.of_ident</span> <span class="id" title="var">heq2</span>) | ()];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Std.clear</span> [<span class="id" title="var">heq2</span> ; (<span class="id" title="var">hr</span>.(<span class="id" title="var">star_ident</span>)); (<span class="id" title="var">hr</span>.(<span class="id" title="var">star_eq</span>))];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsBack</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">throw_pm_exn</span> (<span class="id" title="var">Message.concat</span> (<span class="id" title="var">Message.of_string</span> "mlRewriteBy: failed when rewriting '")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Message.concat</span> (<span class="id" title="var">Message.of_constr</span> (<span class="id" title="var">a</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Message.concat</span> (<span class="id" title="var">Message.of_string</span> "' to/from '")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Message.concat</span> (<span class="id" title="var">Message.of_constr</span> (<span class="id" title="var">a'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Message.concat</span> (<span class="id" title="var">Message.of_string</span> "' in context ")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Message.of_constr</span> (<span class="id" title="var">pc</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
| [|- <span class="id" title="var">_</span>] ⇒ <span class="id" title="var">throw_pm_exn_with_goal</span> "mlRewrite: not in proof mode"<br/>
<span class="id" title="keyword">end</span><br/>
.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlRewriteBy" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name'</span>) "at" <span class="id" title="keyword">constr</span>(<span class="id" title="var">atn</span>) :=<br/>
(<span class="id" title="keyword">let</span> <span class="id" title="var">ff</span> := <span class="id" title="var">ltac2</span>:(<span class="id" title="var">name''</span> <span class="id" title="var">atn</span> |-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mlRewriteBy</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Option.get</span> (<span class="id" title="var">Ltac1.to_constr</span>(<span class="id" title="var">name''</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">constr_to_int</span> (<span class="id" title="var">Option.get</span> (<span class="id" title="var">Ltac1.to_constr</span>(<span class="id" title="var">atn</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id" title="tactic">in</span><br/>
&nbsp;<span class="id" title="var">ff</span> <span class="id" title="var">name'</span> <span class="id" title="var">atn</span>).<br/>

<br/>
<span class="id" title="keyword">Local Example</span> <span class="id" title="var">ex_rewriteBy</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span> <span class="id" title="var">b</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">a'</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">a</span> ⋅ <span class="id" title="var">b</span> ---&gt; (<span class="id" title="var">a'</span> =<span class="id" title="var">ml</span> <span class="id" title="var">a</span>) ---&gt; <span class="id" title="var">a'</span> ⋅ <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_equal_implies_iff</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} (φ1 φ2 : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>) <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ (<span class="id" title="var">free_evars</span> φ1 ∪ <span class="id" title="var">free_evars</span> φ2) →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ1 →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ2 →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ1 =<span class="id" title="var">ml</span> φ2 <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ1 &lt;---&gt; φ2) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_subseteq_refl</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ ⊆<span class="id" title="var">ml</span> φ <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <span class="id" title="var">patt_subseteq_is_reflexive</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} : <span class="id" title="var">MLReflexive</span> <span class="id" title="var">patt_subseteq</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">patt_subseteq_is_reflexive</span> : <span class="id" title="var">core</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <span class="id" title="var">reflexive_subseteq_test</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">_</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">p'</span> <span class="id" title="var">q'</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">p'</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">q'</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">q</span> ---&gt; <span class="id" title="var">q'</span> ---&gt; <span class="id" title="var">p'</span> ---&gt; <span class="id" title="var">p</span> ⊆<span class="id" title="var">ml</span> <span class="id" title="var">p</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">disj_equals_greater_1_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ<span class="id" title="var">₁</span> ∪ <span class="id" title="var">free_evars</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ<span class="id" title="var">₁</span> ⊆<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span>) =<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span> <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">def_not_phi_impl_not_total_phi</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌈ ! φ ⌉ ---&gt; ! ⌊ φ ⌋ <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">def_def_phi_impl_def_phi</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} {<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>} (φ : <span class="id" title="var">Pattern</span>) <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌈ ⌈ φ ⌉ ⌉ ---&gt; ⌈ φ ⌉<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bott_not_defined</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ! ⌈ ⊥ ⌉ <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_def_phi_impl_not_phi</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ! ⌈ φ ⌉ ---&gt; ! φ<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]},<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">tot_phi_impl_tot_def_phi</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ φ ⌋ ---&gt; ⌊ ⌈ φ ⌉ ⌋<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>]},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">def_of_pred_impl_pred</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> ψ :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (ψ =<span class="id" title="var">ml</span> <span class="id" title="var">patt_bott</span>) <span class="id" title="var">or</span> (ψ =<span class="id" title="var">ml</span> <span class="id" title="var">patt_top</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌈ ψ ⌉ ---&gt; ψ <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO&nbsp;need&nbsp;this&nbsp;non-meta&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subseteq_antisym_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ<span class="id" title="var">₁</span> ⊆<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>) <span class="id" title="var">and</span> (φ<span class="id" title="var">₂</span> ⊆<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ<span class="id" title="var">₁</span> =<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span> <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">propagate_membership_conjunct_1</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> <span class="id" title="var">AC</span> <span class="id" title="var">x</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">subst_ctx</span> <span class="id" title="var">AC</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">and</span> ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span>) ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>))) ---&gt; ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span>) ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">double_not_ceil_alt</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">i</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ( ⌈ ! ⌈ φ ⌉ ⌉ ---&gt; (! ⌈ φ ⌉)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ( ⌈ φ ⌉ ---&gt; ! ( ⌈ ! ⌈ φ ⌉ ⌉)) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_imp</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (φ<span class="id" title="var">₁</span> ---&gt; φ<span class="id" title="var">₂</span>)) &lt;---&gt; ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) ---&gt; (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_imp_1</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (φ<span class="id" title="var">₁</span> ---&gt; φ<span class="id" title="var">₂</span>)) ---&gt; ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) ---&gt; (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_imp_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) ---&gt; (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>)) ---&gt; (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (φ<span class="id" title="var">₁</span> ---&gt; φ<span class="id" title="var">₂</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ceil_propagation_exists_1</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span>, φ) →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (⌈ <span class="id" title="var">ex</span>, φ ⌉) ---&gt; (<span class="id" title="var">ex</span>, ⌈ φ ⌉)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ceil_propagation_exists_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span>, φ) →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">ex</span>, ⌈ φ ⌉) ---&gt; (⌈ <span class="id" title="var">ex</span>, φ ⌉)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span>  (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ceil_propagation_exists_iff</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span>, φ) →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (⌈ <span class="id" title="var">ex</span>, φ ⌉) &lt;---&gt; (<span class="id" title="var">ex</span>, ⌈ φ ⌉)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span>  (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_exists</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> ψ <span class="id" title="var">y</span> φ <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span>, φ) →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ <span class="id" title="var">free_evars</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">y</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (ψ ∈<span class="id" title="var">ml</span> (<span class="id" title="var">ex</span>, φ)) &lt;---&gt; (<span class="id" title="var">ex</span>, ψ ∈<span class="id" title="var">ml</span> φ)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_exists_1</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> ψ φ <span class="id" title="var">y</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span>, φ) →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ <span class="id" title="var">free_evars</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">y</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (ψ ∈<span class="id" title="var">ml</span> (<span class="id" title="var">ex</span>, φ)) ---&gt; (<span class="id" title="var">ex</span>, ψ ∈<span class="id" title="var">ml</span> φ)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_exists_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> ψ φ <span class="id" title="var">y</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span>, φ) →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ <span class="id" title="var">free_evars</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">y</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">ex</span>, ψ ∈<span class="id" title="var">ml</span> φ) ---&gt; (ψ ∈<span class="id" title="var">ml</span> (<span class="id" title="var">ex</span>, φ))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_forall_1</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="var">Definedness_Syntax.Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span> , φ) →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>]}-&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">y</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (<span class="id" title="var">all</span> , φ) ---&gt; (<span class="id" title="var">all</span> , <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_forall_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="var">Definedness_Syntax.Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span> , φ) →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">y</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">all</span> , <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> φ) ---&gt; <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> (<span class="id" title="var">all</span> , φ) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_symbol_ceil_aux_aux_0</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> φ <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((⌈ <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> <span class="id" title="var">and</span> φ ⌉) ---&gt; (⌊ ⌈ <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> <span class="id" title="var">and</span> φ ⌉  ⌋))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ceil_compat_in_or</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ( (⌈ φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span> ⌉) &lt;---&gt; (⌈ φ<span class="id" title="var">₁</span> ⌉ <span class="id" title="var">or</span> ⌈ φ<span class="id" title="var">₂</span> ⌉))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> (<span class="id" title="var">ExGen</span> := ∅, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">helper_propositional_lemma_1</span> (<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>) <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> = <span class="id" title="var">true</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (! φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span>) ---&gt; (! φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> (φ<span class="id" title="var">₂</span> <span class="id" title="var">and</span> φ<span class="id" title="var">₁</span>)) <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_symbol_ceil_aux_0</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> φ <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (⌈ <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> <span class="id" title="var">and</span> φ ⌉) ---&gt; ⌈ <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">y</span> <span class="id" title="var">and</span> ⌈ <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> <span class="id" title="var">and</span> φ ⌉ ⌉<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_symbol_ceil_left_aux_0</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>; <span class="id" title="var">y</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ ---&gt; (<span class="id" title="var">ex</span>, ⌈ <span class="id" title="var">b0</span> <span class="id" title="var">and</span> φ ⌉)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ceil_and_x_ceil_phi_impl_ceil_phi</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> (φ : <span class="id" title="var">Pattern</span>) ψ <span class="id" title="var">y</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">y</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ( (⌈ ψ <span class="id" title="var">and</span> ⌈ φ ⌉ ⌉) ---&gt; (⌈ φ ⌉))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
  
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_monotone</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> (φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span> : <span class="id" title="var">Pattern</span>) ψ <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ<span class="id" title="var">₁</span> ---&gt; φ<span class="id" title="var">₂</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (ψ ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₁</span>) ---&gt; (ψ ∈<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">defined_not_iff_not_total</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;∀ (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (φ : <span class="id" title="var">Pattern</span>) <span class="id" title="var">i</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">well_formed</span> φ → <span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌈ ! φ ⌉ &lt;---&gt; ! ⌊ φ ⌋<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_or_total</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> φ ψ <span class="id" title="var">i</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ → <span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span>  ⌊ φ ⌋ <span class="id" title="var">or</span> ⌊ ψ ⌋ ---&gt; ⌊ φ <span class="id" title="var">or</span> ψ ⌋<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_defined_and</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> φ ψ <span class="id" title="var">i</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ → <span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌈ φ <span class="id" title="var">and</span> ψ ⌉ ---&gt; ⌈ φ ⌉ <span class="id" title="var">and</span> ⌈ ψ ⌉<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_symbol_ceil_left</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">z</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>; <span class="id" title="var">y</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">y</span>; <span class="id" title="var">z</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> ⌈ φ ⌉) ---&gt; (<span class="id" title="var">ex</span>, (<span class="id" title="var">patt_bound_evar</span> 0 ∈<span class="id" title="var">ml</span> φ))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_symbol_ceil_right_aux_0</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">i</span> <span class="id" title="var">x</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">ex</span>, (⌈ <span class="id" title="var">b0</span> <span class="id" title="var">and</span>  φ ⌉ <span class="id" title="var">and</span> <span class="id" title="var">b0</span>)) ---&gt; φ<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">formula_of_proof</span> (<span class="id" title="var">t</span> : <span class="id" title="keyword">constr</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">lazy_match</span>! <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| (@<span class="id" title="var">derives_using</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ?<span class="id" title="var">p</span> <span class="id" title="var">_</span>) ⇒ <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Message.print</span> (<span class="id" title="var">Message.concat</span> (<span class="id" title="var">Message.of_string</span> "Cannot obtain a formula from") (<span class="id" title="var">Message.of_constr</span> <span class="id" title="var">t</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Control.throw_invalid_argument</span> "Cannot obtain a matching logic formula from given term"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_symbol_ceil_right</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span> <span class="id" title="var">i</span> <span class="id" title="var">y</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">y</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">ex</span>, (<span class="id" title="var">BoundVarSugar.b0</span> ∈<span class="id" title="var">ml</span> φ)) ---&gt; (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> ⌈ φ ⌉))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">def_phi_impl_tot_def_phi</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">i</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">z</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>; <span class="id" title="var">y</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>; <span class="id" title="var">y</span>; <span class="id" title="var">z</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌈ φ ⌉ ---&gt; ⌊ ⌈ φ ⌉ ⌋<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">def_tot_phi_impl_tot_phi</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">z</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>; <span class="id" title="var">y</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>; <span class="id" title="var">y</span>; <span class="id" title="var">z</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌈ ⌊ φ ⌋ ⌉ ---&gt; ⌊ φ ⌋ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">floor_is_predicate</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">i</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">z</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>; <span class="id" title="var">y</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>; <span class="id" title="var">y</span>; <span class="id" title="var">z</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">is_predicate_pattern</span> (⌊ φ ⌋)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">def_propagate_not</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (! ⌈ φ ⌉) &lt;---&gt; (⌊ ! φ ⌋)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">def_def_phi_impl_tot_def_phi</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">i</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ∉ <span class="id" title="var">free_evars</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">y</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">z</span> ∉ <span class="id" title="var">free_evars</span> φ ∪ {[<span class="id" title="var">x</span>; <span class="id" title="var">y</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>; <span class="id" title="var">x</span>; <span class="id" title="var">y</span>; <span class="id" title="var">z</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌈ ⌈ φ ⌉ ⌉ ---&gt; ⌊ ⌈ φ ⌉ ⌋<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ceil_is_predicate</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">is_predicate_pattern</span> (⌈ φ ⌉)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_elim</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> (<span class="id" title="var">C</span> : <span class="id" title="var">PatternCtx</span>) (ψ : <span class="id" title="var">Pattern</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>) →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_in_evar_path</span> (<span class="id" title="var">pcEvar</span> <span class="id" title="var">C</span>) (<span class="id" title="var">pcPattern</span> <span class="id" title="var">C</span>) 0 = <span class="id" title="var">false</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">emplace</span> <span class="id" title="var">C</span> <span class="id" title="var">patt_bott</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">emplace</span> <span class="id" title="var">C</span> <span class="id" title="var">patt_top</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">emplace</span> <span class="id" title="var">C</span> ψ<br/>
.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_propagate_right_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ <span class="id" title="var">P</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">P</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> ψ ---&gt; ψ <span class="id" title="var">and</span> <span class="id" title="var">P</span> ⋅ <span class="id" title="var">ϕ</span> &lt;---&gt; <span class="id" title="var">P</span> ⋅ (ψ <span class="id" title="var">and</span> <span class="id" title="var">ϕ</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_propagate_right_2_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ <span class="id" title="var">P</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">P</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> ψ → <br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ ψ <span class="id" title="var">and</span> <span class="id" title="var">P</span> ⋅ <span class="id" title="var">ϕ</span> &lt;---&gt; <span class="id" title="var">P</span> ⋅ (ψ <span class="id" title="var">and</span> <span class="id" title="var">ϕ</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_propagate_left_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ <span class="id" title="var">P</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">P</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> ψ ---&gt; ψ <span class="id" title="var">and</span> <span class="id" title="var">P</span> ⋅ <span class="id" title="var">ϕ</span> &lt;---&gt; (ψ <span class="id" title="var">and</span> <span class="id" title="var">P</span>) ⋅ <span class="id" title="var">ϕ</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_propagate_left_2_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ <span class="id" title="var">P</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">P</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ ψ <span class="id" title="var">and</span> <span class="id" title="var">P</span> ⋅ <span class="id" title="var">ϕ</span> &lt;---&gt; (ψ <span class="id" title="var">and</span> <span class="id" title="var">P</span>) ⋅ <span class="id" title="var">ϕ</span>.<br/>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">app_prop_under_implication</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span>: <span class="id" title="keyword">∀</span> φ1 φ2 φ3 ψ,<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ1 →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ2 →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ3 →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> φ3 →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ (φ1 ---&gt; (ψ ⋅ φ2)) ---&gt; (φ1 <span class="id" title="var">and</span> φ3) ---&gt; (ψ ⋅ (φ2 <span class="id" title="var">and</span> φ3)).<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;Put&nbsp;in&nbsp;a&nbsp;different&nbsp;file?&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_propagate_right</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ <span class="id" title="var">P</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">P</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> <span class="id" title="var">P</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ ψ <span class="id" title="var">and</span> <span class="id" title="var">P</span> ⋅ <span class="id" title="var">ϕ</span> &lt;---&gt; <span class="id" title="var">P</span> ⋅ (ψ <span class="id" title="var">and</span> <span class="id" title="var">ϕ</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equal_imp_membership</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ φ' :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ → <span class="id" title="var">well_formed</span> φ' →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ ⌈ φ' ⌉  →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ (φ =<span class="id" title="var">ml</span> φ') ---&gt; (φ ∈<span class="id" title="var">ml</span> φ').<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_impl_ex_in_phi</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">ϕ</span> ---&gt; (<span class="id" title="var">ex</span> , <span class="id" title="var">b0</span> ∈<span class="id" title="var">ml</span> <span class="id" title="var">ϕ</span> <span class="id" title="var">and</span> <span class="id" title="var">b0</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_symbol_right</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> <span class="id" title="var">ϕ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ (<span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> ψ ⋅ <span class="id" title="var">ϕ</span>) ---&gt; (<span class="id" title="var">ex</span> , (<span class="id" title="var">b0</span> ∈<span class="id" title="var">ml</span> <span class="id" title="var">ϕ</span> <span class="id" title="var">and</span> <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ∈<span class="id" title="var">ml</span> ψ ⋅ <span class="id" title="var">b0</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">disj_equals_greater_1</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ<span class="id" title="var">₁</span> ⊆<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>) ---&gt; ((φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span>) =<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">disj_equals_greater_2_meta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span>) =<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span> <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ<span class="id" title="var">₁</span> ⊆<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span> <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">disj_equals_greater_2</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> φ<span class="id" title="var">₁</span> → <span class="comment">(*&nbsp;TODO&nbsp;get&nbsp;rid&nbsp;of&nbsp;it&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span>) =<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>) ---&gt; (φ<span class="id" title="var">₁</span> ⊆<span class="id" title="var">ml</span> φ<span class="id" title="var">₂</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bott_not_total</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ! ⌊ ⊥ ⌋<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_total_and</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> φ ψ,<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ → <span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ φ <span class="id" title="var">and</span> ψ ⌋ &lt;---&gt; ⌊ φ ⌋ <span class="id" title="var">and</span> ⌊ ψ ⌋<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> (<span class="id" title="var">ExGen</span> := ∅, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_var</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">Γ</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">y</span> ∈<span class="id" title="var">ml</span> <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span> ---&gt; <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">y</span> =<span class="id" title="var">ml</span> <span class="id" title="var">patt_free_evar</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mlSpecializeMeta</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> φ ψ, <span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span>→ <br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span> , φ) → <span class="id" title="var">well_formed</span> ψ → <span class="id" title="var">mu_free</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">all</span> , φ) <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span> → <br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">ex</span> , ψ =<span class="id" title="var">ml</span> <span class="id" title="var">b0</span> <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ^[<span class="id" title="tactic">evar</span>: 0 ↦ ψ] <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;make&nbsp;sure&nbsp;that&nbsp;the&nbsp;final&nbsp;<span class="inlinecode"><span class="id" title="tactic">assumption</span></span>&nbsp;does&nbsp;not&nbsp;solve&nbsp;goals&nbsp;we&nbsp;do&nbsp;not&nbsp;want&nbsp;to&nbsp;solve.&nbsp;*)</span><br/>
<span class="id" title="keyword">Tactic Notation</span> "mlSpecMeta" <span class="id" title="var">ident</span>(<span class="id" title="var">hyp</span>) "with" <span class="id" title="keyword">constr</span>(<span class="id" title="var">t</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> (<span class="id" title="tactic">eapply</span> (@<span class="id" title="var">mlSpecializeMeta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">hyp</span>); <span class="id" title="var">try_wfauto2</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>

<br/>
<span class="id" title="keyword">Local Lemma</span> <span class="id" title="var">test_spec</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> φ ψ, <span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span>→ <br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span> , φ) → <span class="id" title="var">well_formed</span> ψ → <span class="id" title="var">mu_free</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">all</span> , φ) <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span> → <br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">ex</span> , ψ =<span class="id" title="var">ml</span> <span class="id" title="var">b0</span> <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ^[<span class="id" title="tactic">evar</span>: 0 ↦ ψ] <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_mlSpecialize</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l₁</span> <span class="id" title="var">l₂</span> <span class="id" title="var">p</span> <span class="id" title="var">t</span> <span class="id" title="var">g</span> <span class="id" title="var">name</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> <span class="id" title="var">p</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">t</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> <span class="id" title="var">p</span>^[<span class="id" title="tactic">evar</span>: 0 ↦ <span class="id" title="var">t</span>]) ::<span class="id" title="var">l₂</span> ) <span class="id" title="var">g</span> <span class="id" title="var">AnyReasoning</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l₁</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> ((<span class="id" title="var">all</span>, <span class="id" title="var">p</span>) <span class="id" title="var">and</span> (<span class="id" title="var">ex</span> , <span class="id" title="var">t</span> =<span class="id" title="var">ml</span> <span class="id" title="var">b0</span>)))::<span class="id" title="var">l₂</span>) <span class="id" title="var">g</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
</div>

<div class="doc">
  This tactic can be used on local hypotheses shaped in the following way:
     (all , φ) and ex , t = b0

</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "mlSpecn" <span class="id" title="keyword">constr</span>(<span class="id" title="var">n</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByIdx</span> <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_mlSpecialize</span>; [ <span class="id" title="tactic">auto</span> | <span class="id" title="var">wf_auto2</span> | <span class="id" title="var">wf_auto2</span> | <span class="id" title="var">_mlReshapeHypsBack</span> ].<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlSpec" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name'</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByName</span> <span class="id" title="var">name'</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_mlSpecialize</span>; [ <span class="id" title="tactic">auto</span> | <span class="id" title="var">wf_auto2</span> | <span class="id" title="var">wf_auto2</span> | <span class="id" title="var">_mlReshapeHypsBack</span> ].<br/>

<br/>
<span class="id" title="keyword">Goal</span> <span class="id" title="keyword">∀</span> (<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>) (<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>) <span class="id" title="var">Γ</span> φ <span class="id" title="var">t</span>, <br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">mu_free</span> φ → <span class="id" title="var">well_formed</span> <span class="id" title="var">t</span> → <span class="id" title="var">well_formed</span> (<span class="id" title="var">ex</span> , φ) →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> (<span class="id" title="var">all</span> , φ) ---&gt; (<span class="id" title="var">ex</span> , <span class="id" title="var">t</span> =<span class="id" title="var">ml</span> <span class="id" title="var">b0</span>) ---&gt; φ^[<span class="id" title="tactic">evar</span>: 0 ↦ <span class="id" title="var">t</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

  TODO: why should x be introduced for proof info (it could be constructed "ony the fly")? Could we avoid this?
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">forall_defined</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> <span class="id" title="var">i</span>, <span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">ProofInfoLe</span> (<span class="id" title="var">ExGen</span> := {[<span class="id" title="var">ev_x</span>]}, <span class="id" title="var">SVSubst</span> := ∅, <span class="id" title="var">KT</span> := <span class="id" title="var">false</span>, <span class="id" title="var">AKT</span> := <span class="id" title="var">false</span>) <span class="id" title="var">i</span>  →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">all</span> , ⌈<span class="id" title="var">b0</span>⌉ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">membership_refl</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> <span class="id" title="var">t</span>, <span class="id" title="var">well_formed</span> <span class="id" title="var">t</span> → <br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span>→ <span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ((<span class="id" title="var">ex</span> , <span class="id" title="var">t</span> =<span class="id" title="var">ml</span> <span class="id" title="var">b0</span>) ---&gt; <span class="id" title="var">t</span> ∈<span class="id" title="var">ml</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_reflexivity</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">ϕ</span> <span class="id" title="var">i</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">_</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> (<span class="id" title="var">ϕ</span> =<span class="id" title="var">ml</span> <span class="id" title="var">ϕ</span>) <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Local Example</span> <span class="id" title="var">mlReflexivity_test</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> → <span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> <span class="id" title="var">ϕ</span> ---&gt; ψ ---&gt; ψ =<span class="id" title="var">ml</span> ψ <span class="id" title="keyword">using</span> <span class="id" title="var">BasicReasoning</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;strengthen&nbsp;proof&nbsp;info&nbsp;about&nbsp;this:&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_symmetry</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> <span class="id" title="var">ϕ</span> ψ <span class="id" title="var">i</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">_</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> (<span class="id" title="var">ϕ</span> =<span class="id" title="var">ml</span> ψ) <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">_</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l</span> (ψ =<span class="id" title="var">ml</span> <span class="id" title="var">ϕ</span>) <span class="id" title="var">i</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;strengthen&nbsp;proof&nbsp;info&nbsp;about&nbsp;this:&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLGoal_symmetryIn</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">name</span> <span class="id" title="var">Γ</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">ϕ</span> ψ <span class="id" title="var">g</span> <span class="id" title="var">i</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">_</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l1</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> (<span class="id" title="var">ϕ</span> =<span class="id" title="var">ml</span> ψ)) :: <span class="id" title="var">l2</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mkMLGoal</span> <span class="id" title="var">_</span> <span class="id" title="var">Γ</span> (<span class="id" title="var">l1</span> ++ (<span class="id" title="var">mkNH</span> <span class="id" title="var">_</span> <span class="id" title="var">name</span> (ψ =<span class="id" title="var">ml</span> <span class="id" title="var">ϕ</span>)) :: <span class="id" title="var">l2</span>) <span class="id" title="var">g</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlSymmetry" :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">tryif</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">MLGoal_symmetry</span>; [<span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">timeout</span> 5 <span class="id" title="var">set_solver</span>|]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="tactic">fail</span> "mlSymmetry: matching logic goal is not an equality".<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlSymmetry" "in" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">_ensureProofMode</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsByName</span> <span class="id" title="var">name</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">tryif</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">MLGoal_symmetryIn</span> <span class="id" title="var">name</span>); [<span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">timeout</span> 5 <span class="id" title="var">set_solver</span>|];<br/>
&nbsp;&nbsp;<span class="id" title="var">_mlReshapeHypsBack</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="tactic">fail</span> "mlSymmetry: given local hypothesis is not an equality".<br/>

<br/>
<span class="id" title="keyword">Local Example</span> <span class="id" title="var">mlSymmetry_test</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> → <span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ψ ---&gt; <span class="id" title="var">ϕ</span> =<span class="id" title="var">ml</span> ψ ---&gt; <span class="id" title="var">ϕ</span> =<span class="id" title="var">ml</span> ψ <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlRewriteBy" "-&gt;" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) "at" <span class="id" title="keyword">constr</span>(<span class="id" title="var">atn</span>) := <span class="id" title="var">mlRewriteBy</span> <span class="id" title="var">name</span> <span class="id" title="tactic">at</span> <span class="id" title="var">atn</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlRewriteBy" "&lt;-" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) "at" <span class="id" title="keyword">constr</span>(<span class="id" title="var">atn</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">mlSymmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">name</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">mlRewriteBy</span> <span class="id" title="var">name</span> <span class="id" title="tactic">at</span> <span class="id" title="var">atn</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">mlSymmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">name</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;Replace&nbsp;with&nbsp;something&nbsp;safer&nbsp;*)</span><br/>
<span class="id" title="keyword">Tactic Notation</span> "mlRewriteBy" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) "at" <span class="id" title="keyword">constr</span>(<span class="id" title="var">atn</span>) "in" <span class="id" title="keyword">constr</span>(<span class="id" title="var">hypo</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">mlRevert</span> <span class="id" title="var">hypo</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">mlRewriteBy</span> <span class="id" title="var">name</span> <span class="id" title="tactic">at</span> <span class="id" title="var">atn</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">mlIntro</span> <span class="id" title="var">hypo</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlRewriteBy" "-&gt;" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) "at" <span class="id" title="keyword">constr</span>(<span class="id" title="var">atn</span>) "in" <span class="id" title="keyword">constr</span>(<span class="id" title="var">hypo</span>) := <span class="id" title="var">mlRewriteBy</span> <span class="id" title="var">name</span> <span class="id" title="tactic">at</span> <span class="id" title="var">atn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hypo</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "mlRewriteBy" "&lt;-" <span class="id" title="keyword">constr</span>(<span class="id" title="var">name</span>) "at" <span class="id" title="keyword">constr</span>(<span class="id" title="var">atn</span>) "in" <span class="id" title="keyword">constr</span>(<span class="id" title="var">hypo</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">mlSymmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">name</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">mlRewriteBy</span> <span class="id" title="var">name</span> <span class="id" title="tactic">at</span> <span class="id" title="var">atn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hypo</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">mlSymmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">name</span>.<br/>

<br/>
<span class="id" title="keyword">Local Example</span> <span class="id" title="var">mlRewriteBy_test_in_barr</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> → <span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;! (ψ ---&gt; <span class="id" title="var">ϕ</span>) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;! (<span class="id" title="var">ϕ</span> =<span class="id" title="var">ml</span> ψ)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Local Example</span> <span class="id" title="var">mlRewriteBy_test_in</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> → <span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;! (ψ ---&gt; <span class="id" title="var">ϕ</span>) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;! (ψ =<span class="id" title="var">ml</span> <span class="id" title="var">ϕ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Local Example</span> <span class="id" title="var">mlRewriteBy_test_barr</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> <span class="id" title="var">ϕ</span> ψ :<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">well_formed</span> <span class="id" title="var">ϕ</span> → <span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(ψ =<span class="id" title="var">ml</span> <span class="id" title="var">ϕ</span>) ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;! ψ ---&gt; ! <span class="id" title="var">ϕ</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;eliminate&nbsp;mu_free&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patt_equal_trans</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} <span class="id" title="var">Γ</span> φ1 φ2 φ3:<br/>
&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ1 → <span class="id" title="var">well_formed</span> φ2 → <span class="id" title="var">well_formed</span> φ3 →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> φ1 → <span class="id" title="var">mu_free</span> φ2 → <span class="id" title="var">mu_free</span> φ3 →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ1 =<span class="id" title="var">ml</span> φ2 ---&gt; φ2 =<span class="id" title="var">ml</span> φ3 ---&gt; φ1 =<span class="id" title="var">ml</span> φ3<br/>
&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="comment">(*&nbsp;These&nbsp;<span class="inlinecode"><span class="id" title="var">are</span></span> <span class="inlinecode"><span class="id" title="var">from</span>/<span class="id" title="var">should</span></span> <span class="inlinecode"><span class="id" title="var">be</span></span> <span class="inlinecode"><span class="id" title="var">part</span></span> <span class="inlinecode"><span class="id" title="keyword">of</span></span>&nbsp;this&nbsp;branch:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;https://github.com/harp-project/AML-Formalization/blob/09f24d95119769ce578c8c15eceba5a3a00c45d4/matching-logic/src/Theories/Nat_ProofSystem.vL392 *)</span><br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">predicate_lemmas</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_equiv</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> φ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> φ ---&gt; φ &lt;---&gt; ⌊φ⌋.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_imp</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> φ ψ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Definedness_Syntax.theory</span> ⊆ <span class="id" title="var">Γ</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> ψ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> φ ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_predicate_pattern</span> ψ ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_predicate_pattern</span> (φ ---&gt; ψ).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_bott</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> ⊥.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_not</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> φ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> φ ---&gt; <span class="id" title="var">is_predicate_pattern</span> (! φ).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_or</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> → <span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> φ<span class="id" title="var">₁</span> ---&gt; <span class="id" title="var">is_predicate_pattern</span> φ<span class="id" title="var">₂</span> ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_predicate_pattern</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predicate_and</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">Γ</span> φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">theory</span> ⊆ <span class="id" title="var">Γ</span> → <span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> → <span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_predicate_pattern</span> φ<span class="id" title="var">₁</span> ---&gt; <span class="id" title="var">is_predicate_pattern</span> φ<span class="id" title="var">₂</span> ---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_predicate_pattern</span> (φ<span class="id" title="var">₁</span> <span class="id" title="var">and</span> φ<span class="id" title="var">₂</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">predicate_lemmas</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">subset_iff_eq</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;∀ (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (φ φ' : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Definedness_Syntax.theory</span> ⊆ <span class="id" title="var">Γ</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ' →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ ⊆<span class="id" title="var">ml</span> φ' <span class="id" title="var">and</span>  φ' ⊆<span class="id" title="var">ml</span> φ &lt;---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;φ =<span class="id" title="var">ml</span> φ' <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">subset_disj</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;∀ (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (φ  φ<span class="id" title="var">₁</span> φ<span class="id" title="var">₂</span> : <span class="id" title="var">Pattern</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">ProofInfo</span>) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Definedness_Syntax.theory</span> ⊆ <span class="id" title="var">Γ</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₁</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ<span class="id" title="var">₂</span>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ( φ<span class="id" title="var">₁</span> <span class="id" title="var">or</span> φ<span class="id" title="var">₂</span> )  ⊆<span class="id" title="var">ml</span> φ   &lt;---&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;φ<span class="id" title="var">₁</span> ⊆<span class="id" title="var">ml</span> φ  <span class="id" title="var">and</span>  φ<span class="id" title="var">₂</span>  ⊆<span class="id" title="var">ml</span> φ <span class="id" title="keyword">using</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">forall_functional_subst_meta</span>: ∀ {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>} (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (φ φ' : <span class="id" title="var">Pattern</span>) ,<br/>
&nbsp;&nbsp;<span class="id" title="var">Definedness_Syntax.theory</span> ⊆ <span class="id" title="var">Γ</span>→<br/>
&nbsp;&nbsp;<span class="id" title="var">mu_free</span> φ →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ' →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed_closed_ex_aux</span> φ 1 →<br/>
&nbsp;&nbsp;<span class="id" title="var">well_formed_closed_mu_aux</span> φ 0 →<br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ <span class="id" title="var">is_functional</span> φ' → <br/>
&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢ (<span class="id" title="var">all</span> , φ) → <span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> φ^[<span class="id" title="tactic">evar</span>:0↦φ'] <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">total_iff_top</span> {<span class="id" title="var">Σ</span> : <span class="id" title="var">Signature</span>} {<span class="id" title="var">syntax</span> : <span class="id" title="keyword">Syntax</span>}:<br/>
&nbsp;&nbsp;∀ (<span class="id" title="var">Γ</span> : <span class="id" title="var">Theory</span>) (φ : <span class="id" title="var">Pattern</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Definedness_Syntax.theory</span> ⊆ <span class="id" title="var">Γ</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_formed</span> φ →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Γ</span> ⊢<span class="id" title="var">i</span> ⌊ φ ⌋ &lt;---&gt;  (φ =<span class="id" title="var">ml</span> <span class="id" title="var">patt_top</span>)     <span class="id" title="keyword">using</span> <span class="id" title="var">AnyReasoning</span>.<br/>
</div>
<hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>